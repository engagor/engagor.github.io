<!DOCTYPE html>
<html>
    <head>
        <title>How to edit a commit message &mdash; CX Social Dev Blog &mdash; Development Blog</title>
        <meta charset="utf-8">
        <meta name="theme-color" content="#ffffff">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
            <meta name="robots" content="index, follow">
        <link href="/components/bootstrap/css/bootstrap.min.css" rel="stylesheet" type="text/css" />
        <link href="/css/style.css" rel="stylesheet" type="text/css" />
        <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
        <!--[if lt IE 9]>
            <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
        <![endif]-->

        <meta name="mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-capable" content="yes">

        <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
        <link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">
        <link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16">
        <link rel="manifest" href="/manifest.json">
        <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#445460">
        <meta name="theme-color" content="#445460">

        <link rel="stylesheet" href="/components/highlightjs/styles/hybrid.css" />
        <link rel="stylesheet" href="https://app.engagor.com/global/icons/engagor-icons/engagor-icons.css" />

        <link rel="alternate" type="application/atom+xml" href="/atom.xml" title="CX Social Dev Blog activity feed" />
        <style>
        /** quick fix because bootstrap <pre> has a background-color. */
        pre code { background-color: inherit; }
        </style>
                                    </head>
    <body>
        <header>
            <nav class="navbar navbar-inverse navbar-fixed-top">
                <div class="container">
                    <div class="navbar-header">
                        <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
                            <span class="sr-only">Toggle navigation</span>
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                        </button>
                        <a class="navbar-brand" id="logo" href="http://developers.engagor.com">
                            <img src="/images/logo_cxsocial.png" />
                            <span class="dev-tagline">developers</span>
                        </a>
                    </div>
                    <div id="navbar" class="collapse navbar-collapse">
                        <ul class="nav navbar-nav">
                            <li>
                                <a href="https://developers.engagor.com/">
                                    <span class="en-icon en-icon-document"></span> API Documentation
                                </a>
                            </li>
                            <li>
                                <a href="http://engagor.github.io/" class="active">
                                    <span class="en-icon en-icon-bubble-2"> Blog
                                </a>
                            </li>
                            <li>
                                <a href="https://developers.engagor.com/team">
                                    <span class="en-icon en-icon-users"></span> Team
                                </a>
                            </li>
                        </ul>
                    </div>
                </div>
            </nav>
        </header>
        <div class="mainContent container">
            <div class="row-fluid">
                <div class="span4 sidebar">
                    <div class="well sidebar-nav">
                        <ul class="dev-nav">
                            <li>
                                <a href="/blog">
                                    <span class="en-icon en-icon-clock"></span> Posts Archive
                                </a>
                            </li>
                            <li>
                                <a href="/blog/categories">
                                    <span class="en-icon en-icon-folder-open"></span> Categories
                                </a>
                            </li>
                            <li>
                                <a href="/blog/tags">
                                    <span class="en-icon en-icon-tag"></span> Tags
                                </a>
                            </li>
                        </ul>
                    </div>
                    <div class="hiring-block">
                        <a href="http://cxsocial.clarabridge.com/jobs" target="blank" class="clearfix">
                            <h2>we're</h2>
                            <h1>Hiring!</h1>
                            <span>Join The Team</span>
                        </a>
                    </div>
                </div>
                <div class="span8 dev-content">
                        <article>
        <header class="page-header">
            <h1>How to edit a commit message</h1>
        </header>

        <div class="post-details">
                        <div class="author-avatar">
                <img src="https://www.gravatar.com/avatar/640a6ee9bca7c5b2d3588d1c38da6adb" alt="Hans Ott avatar" />
            </div>
                                    <div class="author-name">
                Hans Ott
            </div>
                        <div class="post-publish-date">
                on
                <time class="post-publish-date" datetime="2017-04-03T10:00:00+00:00" pubdate>
                    <span class='month'>Apr</span> <span class='day'>3rd</span> <span class='year'>2017</span>
                </time>
            </div>
        </div>

        <div>
            <p>We use GitHub for hosting the code, and issue tracker behind CX Social. As you may already know, you can close issues automatically by adding <code>Closes #issue</code> to a commit message and merging it in the master branch. This is great because I always forget to close the fixed issue (it's also great for cross-linking between issues and commits).</p>

<p>But what if you forgot to add <code>Closes #issue</code> to your commit? Let me teach you a trick to edit a commit message.</p>

<p>Let's make a new directory to test it.</p>

<pre><code class="sh">$ mkdir demo-git-edit
$ cd demo-git-edit
$ git init
Initialized empty Git repository in /Users/hansott/Code/demo-git-edit/.git/
</code></pre>

<p>Okay great. We've got our repository ready. Let's add a file.</p>

<pre><code class="sh">$ touch app.js
</code></pre>

<p>Then add the following contents:</p>

<pre><code class="js">throw new Error('This is a bug!');
</code></pre>

<pre><code class="sh">$ git add app.js
$ git commit -m "Add bug"
[master (root-commit) 308c96d] Add bug
 1 file changed, 1 insertion(+)
 create mode 100644 app.js
</code></pre>

<p>Let's fix the bug by removing it.</p>

<pre><code class="sh">$ echo &gt; app.js
$ git diff
diff --git a/app.js b/app.js
index 128b630..8b13789 100644
--- a/app.js
+++ b/app.js
@@ -1 +1 @@
-throw new Error('This is a bug!');
+
$ git add app.js
$ git commit -m "Fixed bug"
$ git log
* 83ac3a3 Fixed bug
* 308c96d Add bug
</code></pre>

<p>There you go. We forgot <code>Closes #issue</code>. What can we do about it? It's important that you don't push (otherwise you'll have to use <code>--force</code> and you should <strong>never</strong> do that). You should consider committing with <code>$ git commit --amend</code>. It opens a proper text editor (like <a href="http://vim.sourceforge.net/">vim</a>) to write a comprehensive message (instead of using <code>-m "message"</code>).</p>

<p>If you want to edit your last commit you can use:</p>

<pre><code class="sh">$ git commit --amend -m "Fixed bug" -m "Closes #issue"
[master f27a1ca] Fixed bug
 Date: Wed Feb 1 12:31:29 2017 +0100
 1 file changed, 1 insertion(+), 1 deletion(-)
</code></pre>

<p>Did you notice I used <code>-m</code> twice? You can read about it in <a href="/blog/2017/01/24/some-tips-for-a-better-git-history/">Some tips for a better Git history</a>.</p>

<pre><code class="sh">$ git show f27a1ca
ommit f27a1caac3ee33ac3b0ef81040cd2c2f877f13f4
Author: Hans Ott &lt;hans.ott@clarabridge.be&gt;
Date:   Wed Feb 1 12:31:29 2017 +0100

    Fixed bug

    Closes #issue

diff --git a/app.js b/app.js
index 128b630..8b13789 100644
--- a/app.js
+++ b/app.js
@@ -1 +1 @@
-throw new Error('This is a bug!');
+
</code></pre>

<p>Hooray! We did it. What if we added other commits before we realised we forgot? <a href="https://git-scm.com/book/tr/v2/Customizing-Git-Git-Configuration">I'll assume you got a decent text editor configured for git</a>.</p>

<pre><code class="sh">$ git log
* 889da98 Add leftpad
* b1b364c Add library
* 05e664c Fixed bug
* 308c96d Add bug
</code></pre>

<p>We added 2 commits after our bug fix commit. Since <code>$ git commit --amend</code> can only change the last commit, we can't use it. Luckily, we know the secret behind the curtain: it's doing a git rebase of the last commit. Let's use git rebase for great good! Again, be careful, this won't work if you already pushed your work (you can inspect with <code>$ git log --decorate</code>).</p>

<pre><code class="sh">$ git rebase -i 308c96d  # use the commit JUST before the bug fix commit
</code></pre>

<pre><code>.g/r/git-rebase-todo
pick 05e664c Fixed bug
pick b1b364c Add library
pick 889da98 Add leftpad

# Rebase 308c96d..889da98 onto 308c96d (3 commands)
#
# Commands:
# p, pick = use commit
# r, reword = use commit, but edit the commit message
# e, edit = use commit, but stop for amending
# s, squash = use commit, but meld into previous commit
# f, fixup = like "squash", but discard this commit's log message
# x, exec = run command (the rest of the line) using shell
# d, drop = remove commit
#
# These lines can be re-ordered; they are executed from top to  bottom.
#
# If you remove a line here THAT COMMIT WILL BE LOST.
#
# However, if you remove everything, the rebase will be aborted.
#
# Note that empty commits are commented out
</code></pre>

<p>You'll have to replace <code>pick</code> before <code>05e664c Fixed bug</code> with <code>reword</code> and save it. Git will show the commit(s) you selected so you can edit it and save it.</p>

<pre><code>.g/COMMIT_EDITMSG
Fixed bug

Closes #issue
# Please enter the commit message for your changes. Lines starting
# with '#' will be ignored, and an empty message aborts the commit.
#
# Date: Wed Feb 1 12:31:29 2017 +0100
#
# interactive rebase in progress; onto 308c96d
# Last command done (1 command done):
#    reword 05e664c Fixed bug
# Next commands to do (2 remaining commands):
#    pick b1b364c Add library
#    pick 889da98 Add leftpad
# You are currently editing a commit while rebasing branch 'master' on '308c96d'.
#
# Changes to be committed:
#       modified:   app.js
</code></pre>

<pre><code class="sh">$ git rebase -i 308c96d
[detached HEAD 4225a9a] Fixed bug
 Date: Wed Feb 1 12:31:29 2017 +0100
 1 file changed, 1 insertion(+), 1 deletion(-)
Successfully rebased and updated refs/heads/master.
</code></pre>

<pre><code class="sh">$ git show 308c96d
commit 4225a9a3eb74b42772297a2f4b67b58696e11410
Author: Hans Ott &lt;hans.ott@clarabridge.be&gt;
Date:   Wed Feb 1 12:31:29 2017 +0100

    Fixed bug

    Closes #issue

diff --git a/app.js b/app.js
index 128b630..8b13789 100644
--- a/app.js
+++ b/app.js
@@ -1 +1 @@
-throw new Error('This is a bug!');
+
</code></pre>

<p>Hooray! We did it again. Now pat yourself on the back.</p>

        </div>

        <hr />

                    <p class="categories">
                <strong>Categories:</strong>
                                <a href="/blog/categories/Git">Git</a>                            </p>
                            <p class="tags">
                <strong>Tags:</strong>
                                    <a href="/blog/tags/Git" class="tag">Git</a>                            </p>
        
                    <nav class="article">
                <ul>
                                                                <li>Previous: <a class="previous" href="/blog/2017/03/15/vim-ide-quality-control" title="Vim As A PHP IDE - Quality Control"><span class="title">Vim As A PHP IDE - Quality Control</span></a></li>
                                    </ul>
            </nav>
            </article>


<div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'engagor-dev-blog'; // required: replace example with your forum shortname


    
    
    
    
    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function () {
        var dsq = document.createElement('script');
        dsq.type = 'text/javascript';
        dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the
    <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a>
</noscript>

                </div>
            </div>
        </div>
        <footer class="container">
            &copy; 2017 CX Social Dev Blog
        </footer>

        <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
        <script>window.jQuery || document.write('<script src="/components/jquery/jquery.min.js"><\/script>')</script>
        <script src="/components/bootstrap/js/bootstrap.min.js"></script>
                
        
        <script type="text/javascript">
            (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
            })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

            ga('create', 'UA-13086022-2', 'auto');
            ga('send', 'pageview');
        </script>
                <script src="/components/highlightjs/highlight.pack.js"></script>
        <script>hljs.initHighlightingOnLoad();</script>

                    </body>
</html>
