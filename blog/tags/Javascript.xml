<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <title><![CDATA[CX Social Dev Blog]]></title>
    <link href="/blog/tags/Javascript.xml" rel="self"/>
    <link href="/"/>
    <updated>2017-11-15T08:32:54+00:00</updated>
    <id>/</id>
        <generator uri="http://sculpin.io/">Sculpin</generator>
            <entry>
            <title type="html"><![CDATA[When too many API calls are breaking your app]]></title>
            <link href="/blog/2017/11/02/javascript-deferred"/>
            <updated>2017-11-02T10:00:00+00:00</updated>
            <id>/blog/2017/11/02/javascript-deferred</id>
            <content type="html"><![CDATA[<p>A few weeks ago, I was confronted with a strange issue regarding the "followers" component we have in our inbox.
It's a cool feature that gives you the possibility to check which connected Twitter account is following or followed by another Twitter account. Most accounts or users don't have that many connected Twitter profiles but of course there are always some exceptions. One of our customers had more than 100 connected profiles. The process to check the relationship between the profiles is rather easy. We do a call to the back-end for every profile. In the back-end we do an API call to Twitter to fetch the relationship details. So you can imagine it takes some time if we have to do this for many profiles. In the front-end the component became very slow and it looked like the component crashed.</p>

<p><img src="/images/2017-11-02-javascript-deferred/followers.png" alt="CX Social followers dropdown in inbox" /></p>

<p>After finding out what the problem is, the next step is of course solving it. I started with checking the back-end for some improvements. Instead of calling Twitter's API for every single profile, I checked if we could ask for multiple relations at once. Sadly this wasn't the case. So this trail was a dead end.</p>

<p>If we can't change the API, we could try to avoid using the API as much as possible. By caching the result for some time, we could avoid requesting the same data multiple times as this also improves speed. This wasn't a good option either because the received data was already cached by us in the back-end.</p>

<p>The only thing I could still think of was trying to reduce the calls to the Twitter API or to our own API. Changing the back-end would be a lot of work because the endpoint is used in a lot of places in the front-end. So the only option I wanted to consider was making a change in the one place where we had the problem. In the inbox we loop over the profiles and do a seperate call for every profile. For every call to our API, we wait until we have the response before doing a new call. So instead of doing synchronous calls, we should consider doing the calls asynchronously.</p>

<p>Not knowing if this was possible in Javascript, I started searching and fell upon the <code>Promise</code> object, which does exactly what we need. However, <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise">the documentation for Promise on MDN</a> quickly revealed that it's not supported by some browsers we still have to support. After some more digging around the internet, we stumbled upon the <code>Deferred</code> object in jQuery which does almost the same, and works in most browsers. From its documentation:</p>

<blockquote>
  <p>It can register multiple callbacks into callback queues, invoke callback queues, and relay the success or failure state of any synchronous or asynchronous function</p>
</blockquote>

<p>So what we actually have to do is start all the calls to the back-end at once. Once we did that we create a new <code>Deferred</code> object. When all the <code>combinedCalls</code> are done, we can start updating our component. It only has to do one big update and it doesn't take that much time because the calls are all fired at the same time instead of one by one.</p>

<pre><code class="js">var profileIds = this.profileIds;

var calls = _.map(services, function (service) {
    var url = '/twitter/relation?accounts='+ service.id +'&amp;users=' + profileIds;

    return $.get(url);
});

var combinedResult = $.Deferred();

var combinedCalls = $.when.apply($, calls);

combinedCalls.done(function() {

    var resultsOfDefferedAjaxCalls = _.toArray(arguments).slice(0, calls.length);

    var relations = _.map(resultsOfDefferedAjaxCalls, function(ajaxResult) {
        return ajaxResult.result.data;
    });

    combinedResult.resolve(relations);
});

combinedCalls.fail(function() {
    // Combine args so that we can pass reason for
    // failure to reject()
    combinedResult.reject();
});

return combinedResult.promise();
</code></pre>

<p>So with some small changes we improved a lot on the loading time of the dropdown. The next problem was that some calls could take some time and if there is one slow call, all the other calls have to wait till the slowest call is finished. So I had to find another solution for this new problem. So instead of just calling the endpoint I added a callback function to the call.</p>

<pre><code class="js">var calls = _.map(services, function (service) {
    var url = '/twitter/relation?accounts='+ service.id +'&amp;users=' + profileIds;

    var onGoingCall = $.get(url);

    onGoingCall.done(callback);

    return onGoingCall;
});
</code></pre>

<p>The moment the call is finished, the callback is triggered and the component will update. You don't have to worry about slow calls because the component will update as soon as possible and the customer can see that data is loading and updating.</p>

<p>That's how we fixed this for now, hopefully we can move to the more modern approach of using <code>Promise</code> in the near future!</p>
]]></content>
        </entry>
            <entry>
            <title type="html"><![CDATA[A trip to Nordic.js ‚úàÔ∏è]]></title>
            <link href="/blog/2017/09/15/nordicjs"/>
            <updated>2017-09-15T10:00:00+00:00</updated>
            <id>/blog/2017/09/15/nordicjs</id>
            <content type="html"><![CDATA[<p><center>
<img src="/images/2017-09-15-nordicjs/nordicjs.png" alt="Nordic.js cover" /><br />
</center></p>

<p>This year I was finally able to make it to <a href="http://nordicjs.com/">Nordic.js</a> whoot whoot.
This conference deserves to be on your radar! Read on for some impressions from a fellow dev.</p>

<h2 id="talks-%F0%9F%91%A9%E2%80%8D%F0%9F%8F%AB%F0%9F%91%A8%E2%80%8D%F0%9F%8F%AB">Talks üë©‚Äçüè´üë®‚Äçüè´</h2>

<p><em>At the time of writing no videos are online but they will be soonish. Check the <a href="https://www.youtube.com/user/nordicjs">Nordic.js youtube channel</a> for updates.</em></p>

<p>This was the first single track conference I went to and I actually prefer this format compared to multi-track conferences where you always tend to shift to things familiar. "Just serve me the menu, I trust the chefs" is much more enjoyable, and oh boy these chefs deserve some Michelin stars because the menu was delicious.</p>

<p>Talks were about Javascript, frontend development in general and the Javascript community. Below a small list of my favourites.</p>

<h3 id="sociolinguistics-and-the-javascript-community%3A-a-love-story"><a href="http://nordicjs.com/speakers#harriet-lawrence">Sociolinguistics and the Javascript community: a love story</a></h3>

<p>Let's start with "community". 
The most surprising talk of the conference was about sociolinguistics.
Not something that I would choose on a multi-track conference but super glad I saw this one. Small things can make a huge difference, and I love that.</p>

<blockquote class="twitter-tweet" data-lang="en"><p lang="en" dir="ltr">Don‚Äôt use words like ‚Äúeasy‚Äù or ‚Äúsimple‚Äù in instructions so users don‚Äôt feel ashamed if they fail. Brilliant talk <a href="https://twitter.com/harrietgl">@harrietgl</a>! üëè <a href="https://twitter.com/hashtag/NordicJS?src=hash">#NordicJS</a> <a href="https://t.co/4aly56IzC0">pic.twitter.com/4aly56IzC0</a></p>&mdash; Jyri Tuulos (@jtuulos) <a href="https://twitter.com/jtuulos/status/905736469226151936">September 7, 2017</a></blockquote>

<p><em>video coming soon</em></p>

<h3 id="best-practices-for-reusable-ui-components"><a href="http://nordicjs.com/speakers#mars-jullian">Best Practices for reusable UI components</a></h3>

<p>Next up was a talk about React, which we use day to day at CXSocial, so any talk about it is always insightful. You often think big companies use complex techniques but actually everything can be pretty straightforward. Great tips from Mars and if you are starting out with React you should definitely check them out.</p>

<blockquote class="twitter-tweet" data-lang="en"><p lang="en" dir="ltr">Reusable UI components should be: <br>1. self-sufficient<br>2. easy to integrate with<a href="https://twitter.com/marsjosephine">@marsjosephine</a> <a href="https://twitter.com/hashtag/nordicjs?src=hash">#nordicjs</a> <a href="https://twitter.com/hashtag/react?src=hash">#react</a> ‚öõ</p>&mdash; Nordic.js (@nordicjs) <a href="https://twitter.com/nordicjs/status/905780159248310272">September 7, 2017</a></blockquote>

<p><em>video coming soon</em></p>

<h3 id="p2p"><a href="http://nordicjs.com/speakers#feross-aboukhadijeh">P2P</a></h3>

<p>How did I miss that P2P is a thing now in browsers? Luckily we got this great intro by Feross.</p>

<blockquote class="twitter-tweet" data-lang="en"><p lang="en" dir="ltr">I love how <a href="https://twitter.com/feross">@feross</a> has just given a super approachable talk about peer to peer üíñ also with great slides and demos! <a href="https://twitter.com/hashtag/nordicjs?src=hash">#nordicjs</a></p>&mdash; fantastic ms. üá∏üá™ (@fox) <a href="https://twitter.com/fox/status/906132074058457092">September 8, 2017</a></blockquote>

<p><em>video coming soon</em></p>

<h2 id="conference-%F0%9F%8E%9F">Conference üéü</h2>

<p>Here are some things that things that made the conference stand out:</p>

<h3 id="make-new-friends-%F0%9F%91%AD%F0%9F%91%AB">Make new friends üë≠üë´</h3>

<p>Nordic.js does everything in it's power to make everyone feel welcome and loved. The diverse group of people that show up is a testimony to that. A community I feel proud to be a part of.</p>

<p>The conference organizes "Dinner with new friends", a fun way to meet new people. They book a table at a restaurant in Stockholm for you and 5 other people from the conference. If you are a shy person like me you instantly have 5 new conference buddies.</p>

<h3 id="festen-%F0%9F%8E%89">Festen üéâ</h3>

<p>During the conference after party you can participate in a "Code In The Dark" competition. Create a HTML frontend site without testing your code. Does it scare you? Well me too but it's fun to watch brave souls attempt it, I suddenly understand sports now. Why wait until the conference you can actually organize it yourself just check <a href="http://codeinthedark.com/">codeinthedark.com</a>.</p>

<blockquote class="twitter-tweet" data-lang="en"><p lang="en" dir="ltr">The Code in the Dark has started! What a cool experience! <a href="https://twitter.com/hashtag/NordicJS?src=hash">#NordicJS</a> <a href="https://twitter.com/hashtag/JavaScript?src=hash">#JavaScript</a> <a href="https://twitter.com/hashtag/FrontEnd?src=hash">#FrontEnd</a> <a href="https://t.co/0A2gnzT2bl">pic.twitter.com/0A2gnzT2bl</a></p>&mdash; Sweet Systems (@sweet_systems) <a href="https://twitter.com/sweet_systems/status/906196233945055232">September 8, 2017</a></blockquote>

<script async src="//platform.twitter.com/widgets.js" charset="utf-8"></script>

<p>And the party well what can I say that's the most epic funtastic awesomist conference after party ever.</p>

<blockquote class="instagram-media" data-instgrm-version="7" style=" background:#FFF; border:0; border-radius:3px; box-shadow:0 0 1px 0 rgba(0,0,0,0.5),0 1px 10px 0 rgba(0,0,0,0.15); margin: 1px; max-width:658px; padding:0; width:99.375%; width:-webkit-calc(100% - 2px); width:calc(100% - 2px);"><div style="padding:8px;"> <div style=" background:#F8F8F8; line-height:0; margin-top:40px; padding:38.47222222222222% 0; text-align:center; width:100%;"> <div style=" background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACwAAAAsCAMAAAApWqozAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAMUExURczMzPf399fX1+bm5mzY9AMAAADiSURBVDjLvZXbEsMgCES5/P8/t9FuRVCRmU73JWlzosgSIIZURCjo/ad+EQJJB4Hv8BFt+IDpQoCx1wjOSBFhh2XssxEIYn3ulI/6MNReE07UIWJEv8UEOWDS88LY97kqyTliJKKtuYBbruAyVh5wOHiXmpi5we58Ek028czwyuQdLKPG1Bkb4NnM+VeAnfHqn1k4+GPT6uGQcvu2h2OVuIf/gWUFyy8OWEpdyZSa3aVCqpVoVvzZZ2VTnn2wU8qzVjDDetO90GSy9mVLqtgYSy231MxrY6I2gGqjrTY0L8fxCxfCBbhWrsYYAAAAAElFTkSuQmCC); display:block; height:44px; margin:0 auto -44px; position:relative; top:-22px; width:44px;"></div></div><p style=" color:#c9c8cd; font-family:Arial,sans-serif; font-size:14px; line-height:17px; margin-bottom:0; margin-top:8px; overflow:hidden; padding:8px 0 7px; text-align:center; text-overflow:ellipsis; white-space:nowrap;"><a href="https://www.instagram.com/p/BYy1yxMhcP0/" style=" color:#c9c8cd; font-family:Arial,sans-serif; font-size:14px; font-style:normal; font-weight:normal; line-height:17px; text-decoration:none;" target="_blank">Een bericht gedeeld door Peter van der Meulen (@hendrikpetertje)</a> op <time style=" font-family:Arial,sans-serif; font-size:14px; line-height:17px;" datetime="2017-09-08T21:01:47+00:00">8 Sep 2017 om 2:01 PDT</time></p></div></blockquote>

<p><script async defer src="//platform.instagram.com/en_US/embeds.js"></script>
<small>Me and some new conference friends with an old familiar.</small></p>

<h2 id="practical-%F0%9F%92%B5">Practical üíµ</h2>

<p>Some prices if you are trying to conference on a budget.</p>

<ul>
<li>Ticket: Regular Bird - 678 euro</li>
<li>Flights: Brussels Zaventem &lt;=> Stockholm Bromma (Brussels airlines) - 95 euro</li>
<li>Lodging: Skanstulls Vandrarhem 3 nights - 83 euro</li>
</ul>

<h2 id="tips-%E2%9C%94">Tips ‚úî</h2>

<p>I walked everywhere during my trip (except from the airport to the city center). Stockholm is a beautiful city and very pedestrian-friendly.</p>

<p>Want to buy tickets for next year? Sign up for the <a href="http://nordicjs.com">Nordic.js newsletter</a> and be fast very fast because it sells out quickly.</p>

<script async src="//platform.twitter.com/widgets.js" charset="utf-8"></script>
]]></content>
        </entry>
    </feed>