<!DOCTYPE html>
<html>
    <head>
        <title>Home &mdash; CX Social Dev Blog</title>
        <meta charset="utf-8">
        <meta name="theme-color" content="#ffffff">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta name="image" content="/images/404.gif">
        <meta property="og:image" content="/images/404.gif"/>
        <meta name="twitter:image" content="/images/404.gif"/>
                    <meta name="robots" content="noindex, follow">
                <link href="/components/bootstrap/css/bootstrap.min.css" rel="stylesheet" type="text/css" />
        <link href="/css/style.css" rel="stylesheet" type="text/css" />
        <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
        <!--[if lt IE 9]>
            <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
        <![endif]-->

        <meta name="mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-capable" content="yes">

        <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
        <link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">
        <link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16">
        <link rel="manifest" href="/manifest.json">
        <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#445460">
        <meta name="theme-color" content="#445460">

        <link rel="stylesheet" href="/components/highlightjs/styles/hybrid.css" />
        <link rel="stylesheet" href="https://app.engagor.com/global/icons/engagor-icons/engagor-icons.css" />

        <link rel="alternate" type="application/atom+xml" href="/atom.xml" title="CX Social Dev Blog activity feed" />
        <style>
        /** quick fix because bootstrap <pre> has a background-color. */
        pre code { background-color: inherit; }
        </style>
                                    </head>
    <body>
        <header>
            <nav class="navbar navbar-inverse navbar-fixed-top">
                <div class="container">
                    <div class="navbar-header">
                        <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
                            <span class="sr-only">Toggle navigation</span>
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                        </button>
                        <a class="navbar-brand" id="logo" href="http://developers.engagor.com">
                            <img src="/images/logo_cxsocial.png" />
                            <span class="dev-tagline">developers</span>
                        </a>
                    </div>
                    <div id="navbar" class="collapse navbar-collapse">
                        <ul class="nav navbar-nav">
                            <li>
                                <a href="https://developers.engagor.com/">
                                    <span class="en-icon en-icon-document"></span> API Documentation
                                </a>
                            </li>
                            <li>
                                <a href="http://engagor.github.io/" class="active">
                                    <span class="en-icon en-icon-bubble-2"> Blog
                                </a>
                            </li>
                            <li>
                                <a href="https://developers.engagor.com/team">
                                    <span class="en-icon en-icon-users"></span> Team
                                </a>
                            </li>
                        </ul>
                    </div>
                </div>
            </nav>
        </header>
        <div class="mainContent container">
            <div class="row-fluid">
                <div class="span4 sidebar">
                    <div class="well sidebar-nav">
                        <ul class="dev-nav">
                            <li>
                                <a href="/blog">
                                    <span class="en-icon en-icon-clock"></span> Posts Archive
                                </a>
                            </li>
                            <li>
                                <a href="/blog/categories">
                                    <span class="en-icon en-icon-folder-open"></span> Categories
                                </a>
                            </li>
                            <li>
                                <a href="/blog/tags">
                                    <span class="en-icon en-icon-tag"></span> Tags
                                </a>
                            </li>
                        </ul>
                    </div>
                    <div class="hiring-block">
                        <a href="http://www.clarabridge.com/jobs" target="blank" class="clearfix">
                            <h2>we're</h2>
                            <h1>Hiring!</h1>
                            <span>Join The Team</span>
                        </a>
                    </div>
                </div>
                <div class="span8 dev-content">
                        <article>
        <header class="page-header">
            <h1><a href="/blog/2018/03/02/lambda-lists-to-wrap-failure">Lambda To The Rescue: Lists to wrap failure</a></h1>
        </header>
        <div>
            <p><strong>This is the first post in a series about using Functional Programming concepts to make your Object Oriented code more comprehensible. Hang tight for more.</strong></p>

<h2 id="readability">Readability</h2>

<p>When we're reading code, one of the most important blocking factors is cognitive overhead. Minimize it, and your code instantly becomes easier to read and understand. Or is it the other way 'round? After some years of playing with functional programming languages in my spare time, I saw some things that functional programming does great in this field. One of them involves lists.</p>

<p>As you might know, lists are among the most important datastructures in functional programming, if not the most important. There's even a whole family of programming languages that took their name from them. Looking at you <a href="https://en.wikipedia.org/wiki/Lisp_(programming_language)">Lisp</a> üòò!</p>

<p>Let's dive in with a typical legacy PHP method discovered in the wild:</p>

<pre><code class="php">&lt;?php

function words($string)
{
    if (empty($string)) {
        return false;
    }

    return explode(' ', $string);
}

var_dump(words('')); // returns false
var_dump(words('foo bar baz')); // returns ['foo', 'bar', 'baz'];
</code></pre>

<p>The reason the <code>empty</code> check is there, apparently, is that <code>explode(' ', $s)</code> with an empty string will return <code>['']</code> a list with an empty string in it, which is really strange and non-desirable. Arguably, if the <code>$string</code> variable can't be empty, we should throw an exception. But let's say we want to explore our options here. Before I look into the body of a function, I always try to understand it as a black blox.</p>

<blockquote>
  <p>If I pass <code>words</code> a string, it returns an <code>array</code> of words in the string. Except that for empty strings, it will return <code>false</code>.</p>
</blockquote>

<p>Now, the "black box" already has some mystery to it. Why does it return <code>false</code>? Let's defer the answer to it, and check out if we can write the PHP7 type annotations for it.</p>

<pre><code class="php">function words(string $string): array
{
    // ...
}
</code></pre>

<p>Now, this is not correct. The exception that is made for empty strings can't be written as a type. In old-skool PHP they would've written a DocBlock like this:</p>

<pre><code class="php">/**
 * @param string $string
 * @return array|false depending on failure
 */
function words($string)
{
    // ...
}
</code></pre>

<p>But that is a type signature that is unrepresentable usinig PHP7 types. What if we would represent failure using an empty array?</p>

<pre><code class="php">function words(string $string): array
{
    if (empty($string)) {
        return array();
    }

    return explode(' ', $string);
}
</code></pre>

<p>Now the type signature just works. We turned "failure" into a valid result that we can work with. For instance, all code that works with the return value of this method can now just work with arrays. The type signature now tells a story about the function too:</p>

<blockquote>
  <p>If I pass <code>words</code> a string, it returns an <code>array</code> of words in the string.</p>
</blockquote>

<p>The base case where the string is empty is now logical: an empty string has no words, so a list of 0 words is returned.</p>

<h2 id="chaining-calls">Chaining calls</h2>

<p>Now, let's say we have a function <code>chars</code> that returns a list of chars in a string:</p>

<pre><code class="php">function chars(string $string): array
{
    if (empty($string)) {
        return array();
    }

    return str_split($string);
}
</code></pre>

<p>We're thinking we should be able to use this to list all the characters that appear within words. Would this work?</p>

<pre><code class="php">chars(words('foo bar baz'));
</code></pre>

<p>No... We get a fatal error <code>Fatal error: Uncaught TypeError: Argument 1 passed to chars() must be of the type string, array given</code>. Of course, the result of <code>words</code> is an array, which cannot be used as input to our <code>chars</code> function. Let's use <code>array_map</code>:</p>

<pre><code class="php">array_map(@chars, words('foo bar baz'));
</code></pre>

<p><em>don't worry about the <code>@</code>, it's a trick that I learned while working on <a href="https://github.com/mathiasverraes/lambdalicious/">lambdalicious</a>. <code>@</code> is PHP's error suppressing operator. In this case it allows us to write a function's name as a string, without using string notation, so that it's visually different from a string, BUT is interpreted by PHP as a string...</em></p>

<p>We get this:</p>

<pre><code class="php">[["f","o","o"],["b","a","r"],["b","a","z"]]
</code></pre>

<p>Of course, after mapping <code>chars</code> over the words, this is what we get... But actually, we wanted this:</p>

<pre><code class="php">["f","o","o","b","a","r","b","a","z"]
</code></pre>

<p>So how do we get there? We "flatten" the arrays by using <code>concat</code>, which does not exist in php. Let's write it ourselves:</p>

<pre><code class="php">function array_concat(array $arrays): array
{
    return call_user_func_array(
        @array_merge,
        array_merge(array(array()), $arrays)
    );
}
</code></pre>

<p>Now we can use it to flatten the array:</p>

<pre><code class="php">array_concat(array_map(@chars, words('foo bar baz')));
</code></pre>

<p>TADAAAA üòÜ We get what we wanted!</p>

<pre><code class="php">["f","o","o","b","a","r","b","a","z"]
</code></pre>

<p>Let's call this combination of <code>array_map</code> and <code>array_concat</code> <code>array_bind</code> for now:</p>

<pre><code class="php">function array_bind(array $array, $f)
{
    return array_concat(array_map($f, $array));
}
</code></pre>

<p><code>array_bind</code> takes an array of values, and a function that operates of one of those values and returns an array. It returns a new array of values.</p>

<pre><code class="php">array_bind(array_bind(array('foo bar baz'), @words), @chars);
// returns ["f","o","o","b","a","r","b","a","z"]
</code></pre>

<p>Now that we have the <code>array_bind</code> function, we can apply functions to something in an array, and the result will always be an array! What happens if we first bind <code>words</code> and then bind <code>chars</code> to an empty string?</p>

<pre><code class="php">array_bind(array_bind(array(''), @words), @chars); // returns []
</code></pre>

<p>We get an empty array back, which is great!</p>

<p>You saw me wrap the empty string in an array, to be able to use <code>array_bind</code>. This is an act of "providing context". The array serves as a context wrapper for results of the chained functions <code>words</code> and <code>chars</code>. We'll always get our result as an array. If anywhere in the process something fails, we get an empty array, otherwise we get an array with value(s) in it.</p>

<p>I must admit, this doesn't look really great. Let's take a look at how this works in <a href="https://www.haskell.org/">Haskell</a>, a pure functional language.</p>

<p>Now, this is the equivalent of what we wrote earlier on in PHP:</p>

<pre><code class="haskell">pure "" &gt;&gt;= words &gt;&gt;= chars
</code></pre>

<pre><code class="haskell">pure "foo bar baz" &gt;&gt;= words &gt;&gt;= chars
</code></pre>

<p>These return <code>[]</code> and <code>["f","o","o","b","a","r","b","a","z"]</code>, as expected, but how?</p>

<ul>
<li><code>pure</code> wraps the string in our "wrapper" list.</li>
<li><code>&gt;&gt;=</code> is the <code>bind</code> infix function; it takes the "wrapped" value on the left, and applies the function on the right to the wrapped value. It then returns a new wrapped value.</li>
<li><code>words</code> takes a <code>String</code> and returns a list of strings <code>[String]</code>, split by spaces. It's in Haskell's default module <code>Prelude</code>.</li>
<li><p><code>chars</code> is a function we made up, it takes a <code>String</code> and returns a list of strings <code>[String]</code>. By default, <code>String</code>s in Haskell are lists of <code>Char</code>s. To break up a given string in a list of strings that represent chars we need to map over the input string. The mapping function <code>(\x -&gt; [x])</code> gets a <code>Char</code> as input and returns a <code>String</code> by wrapping the given <code>Char</code> in a list; check it out:</p>

<pre><code class="haskell">chars :: String -&gt; [String]
chars s = map (\x -&gt; [x]) s
</code></pre></li>
</ul>

<p>As you can see, Haskell was made for this kind of stuff... It also reads a lot better than our PHP implementation.</p>

<h2 id="expanding-on-this-concept">Expanding on this concept</h2>

<p>The reason this doesn't really work in PHP is that we don't have infix operators at our disposal. I've seen <a href="https://github.com/phunkie/phunkie">libraries</a> that do something with method calls along these lines:</p>

<pre><code class="php">pure('foo bar baz')-&gt;bind(@words)-&gt;bind(@chars);
</code></pre>

<p>which already looks a lot better than what we came up with. Failure can be encapsulated. There's a lot less boilerplate code to read. There's no checking for empty arrays or failure, while it still behaves as we wanted.</p>

<ul>
<li><code>pure()</code> wraps the value in an object.</li>
<li><code>bind()</code> is equivalent to returning a new wrapper object with the result of the applied function to the previously wrapped value. Internally it could all work using <code>arrays</code>, but it could just as well be done differently.</li>
</ul>

<p>For now, we've always worked with functions that return a number of results, but this whole concept can just as well be used with functions that are supposed to return a single result, like integer division <code>div</code>:</p>

<pre><code class="php">function div(int $divident, int $divisor): WrappedValue
{
    if ($divisor === 0) {
        return nothing();
    }

    return pure(intdiv($divident, $divisor));
}
</code></pre>

<p>Now, we created an integer division function that doesn't throw <code>DivisionByZeroError</code> exceptions, but uses this system of <code>WrappedValue</code>s to wrap it's return value on success (using <code>pure</code>, equivalent to an array with a value) or on failure (using <code>nothing</code>, equivalent to an empty array). Now, if we want to square the result of this, we can just bind <code>square</code> to the result of the previous computation.</p>

<pre><code class="php">function square(int $number): WrappedValue
{
    return pure($number * $number);
}

var_dump(div(10, 2)-&gt;bind(@square)); // [25]
var_dump(div(10, 0)-&gt;bind(@square)); // []
</code></pre>

<p>As with the previous examples, we can now just focus on the order of computation, without the need to worry about failure in the in-between steps.</p>

<p>There are also ways to make this whole thing even more interesting by providing more info like error messages in case of failure.</p>

<h2 id="day-to-day-usage">Day-to-day usage</h2>

<p>I'm not saying this is perfect for everything in OOP by any means, but we might want to think about how we handle failure in our (legacy) systems. I sometimes see trees of exception handling and boolean/null-checks on return values. This is a third option (PHP doesn't have option types by default); In lots of ways, the classic <a href="https://en.wikipedia.org/wiki/Null_object_pattern">Null Object</a> pattern resembles this whole thing in a more Object Oriented way. In many functional programming languages this is actually the most widely used means of error handing. If you want to know more about it, I suggest reading up on <code>Functors</code>, <code>Applicatives</code>, and <code>Monads</code>. Scary names for new concepts, don't let them hold you back.</p>

<p>If you want to do the most simple and useful thing: think about how your functions behave. What goes in, what comes out? Writing the type annotations helps a lot. And of course, throwing exceptions is not a sin.</p>

<p>Happy programming y'aŒªŒª! üëã</p>

<h2 id="what%27s-next%3F">What's next?</h2>

<p>Upcoming <em>lambda to the rescue</em> posts will be linked here:</p>

<ul>
<li><a href="/blog/2018/06/04/lambda-pure-functions">pure functions</a></li>
<li>...</li>
</ul>

        </div>
                    <p class="tags">
            <strong>Tags:</strong>
                        <a href="/blog/tags/PHP" class="tag">PHP</a>                        <a href="/blog/tags/Functional%20Programming" class="tag">Functional Programming</a>                        <a href="/blog/tags/Development" class="tag">Development</a>                        <a href="/blog/tags/Haskell" class="tag">Haskell</a>                        </p>
            </article>
    <article>
        <header class="page-header">
            <h1><a href="/blog/2018/02/21/why-vim-doesnt-need-multiple-cursors">Why Vim Doesn&#039;t Need Multiple Cursors</a></h1>
        </header>
        <div>
            <p>We're back with a Vim Special! A lot of people that get to the point where they want to learn Vim often start looking for a plugin to do something like the Multiple Cursors feature that they're used to from other text editors. This post will try to show you why you don't need this feature in Vim.</p>

<p>Let's jump right in with the first basic feature that Vim provides us to make life simple.</p>

<h2 id="%60%3B.%60-repeat-movement%2C-repeat-command"><code>;.</code> Repeat movement, Repeat command</h2>

<p>As you know, almost all <em>movements</em> in Vim can be done efficiently and fast, using e.g. <code>h j k l w b e f t F T ( ) { }</code>. The cool thing is, Vim remembers the last movement you made and makes it available to repeat immediately using the <code>;</code> key. If you just jumped to the last word beginning with <code>I</code> by typing <code>FI</code>, you can jump back even more by using <code>;</code>.</p>

<p>Next up is the <em>command</em>. For instance, we want to lowercase the letter we jumped to: <code>gul</code>. Vim also remembers this command and makes it available using the dot operator: <code>.</code>.</p>

<p>You can now combine those to repeat movement and action over multiple occurences.</p>

<h2 id="%60%2F%60-search%2C-%60gn%60-text-object%2C-dot-operator"><code>/</code> Search, <code>gn</code> Text object, Dot operator</h2>

<p>If you want to combine the power of Vim's search with the dot operator, that's perfectly possible. Let's say you searched for <code>/ruby\|php\|python\|javascript\|java</code> and want to replace some of the matches with <code>Haskell</code>. Just jump to the first one using <code>n</code> and replace it using the <code>gn</code> text object, like this: <code>cgn</code> type <code>Haskell</code> and then hit <code>&lt;Esc&gt;</code>. Since <code>cgn</code> is a command, we can now use <code>.</code> the dot operator to repeat that. If you want to skip an occurrence or undo what you did you can use <code>n</code> and <code>u</code> respectively.</p>

<h2 id="search-%26-replace-with-confirm">Search &amp; Replace with confirm</h2>

<ul>
<li><p>You most probably know you can search &amp; replace in your whole file by using</p>

<pre><code>:%s/search goes here/replace goes here/g
</code></pre></li>
<li><p>or in a visual selection by making a visual selection using <code>v</code> or <code>V</code> and then typing</p>

<pre><code>:s/search goes here/replace goes here/g
</code></pre>

<p>you should see something like <code>:'&lt;, '&gt;s/search/replace/</code> which is again some Vim magic. <code>'&lt;</code> points to the beginning of the last visual select, and <code>'&gt;</code> to the end of it. The <code>,</code> that separates them is making a range of it. It's like saying <code>:1,5</code> if you want to do something with the first 5 lines of your file.</p></li>
</ul>

<p>Now, this is really nice, but you might want to skip some matches, or you want to be sure that you don't replace matches that you didn't want to replace. You can use the <code>c</code> modifier to your search, and Vim will ask you to confirm every match using <code>y</code> or <code>n</code>. E.g.:</p>

<pre><code>:'&lt;, '&gt;s/search/replace/gc
</code></pre>

<h2 id="visual-block-mode">Visual Block mode</h2>

<p>If the things you want to change are neatly aligned with each other, you can make a Visual Block change:</p>

<pre><code>point 1
point 2
point 3
point 4
</code></pre>

<p>I want to uppercase those first <code>p</code>'s of the words, and I want to make this an enumeration using <code>-</code>. Let's make a Visual Block selection in the beginning of those lines using <code>0&lt;C-v&gt;3j</code> and then use <code>U</code> to uppercase the first letters. Then <code>gv</code> to go back to the visual select and <code>I- &lt;Esc&gt;</code> to make the enumeration happen.</p>

<pre><code>- Point 1
- Point 2
- Point 3
- Point 4
</code></pre>

<h2 id="macro%27s">Macro's</h2>

<p>If you need to do more than just a few inserts or updates on multiple lines or more complicated edits in json, for instance, Vim's macro's can really come in handy. They allow you to "record" a sequence of edits and movements, and replay that sequence as many times as you want. Let's see how we can use this to convert some copied JSON to a PHP array:</p>

<pre><code class="json">{
    "foo": "bar",
    "baz": "qux",
    "vim": "sexy",
    "rest": "lazy"
}
</code></pre>

<ul>
<li>We'll start with the cursor on the first <code>:</code> of the file. We'll start recording to register <code>i</code> by pressing <code>qi</code>.</li>
<li>As a standard practice, and to increase our chances to reproduce this on the following lines, the first thing I do is move the cursor to the first character of the row: <code>^</code>.</li>
<li>Then, we'll replace the double quotes we're on with single quotes using <code>r'</code> and look for the next one using <code>f"</code>. This can now be repeated using the dot operator <code>.</code> and the repeat movement operator <code>;</code>.</li>
<li>We return to the <code>:</code> by using <code>F:</code> and replace it with <code>=&gt;</code> by issuing this command: <code>cw =&gt;</code></li>
<li>We did all changes to the first line, so we can end our recording by going to the next line using <code>j</code> (again, to increase our chances of repeating this easily), and ending the recording with <code>q</code>.</li>
<li>repeating this is as easy as executing the register <code>i</code> to which we recorded this using <code>@i</code>. You can also use a multiplyer if you need to do this 100 times: <code>100@i</code>.</li>
</ul>

<p>We now have</p>

<pre><code>{
    'foo' =&gt; 'bar',
    'baz' =&gt; 'qux',
    'vim' =&gt; 'sexy',
    'rest' =&gt; 'lazy'
}
</code></pre>

<p>Changing the brackets to PHP's <code>array()</code> should be easy.</p>

<h2 id="conclusion">Conclusion</h2>

<p>I hear you: you now need to learn 5 different ways of doing replaces which could all be solved by using multiple cursors. But all of these have some great benefits. They are deliberately executed on a piece of text, you can undo them easily (and one by one), and they are faster and less error-prone than multiple cursors (when you know them by heart). Also, Vim's autocompletion keeps working when using them, as opposed to all multiple cursor plugins that I've tried.</p>

<p>That said, I still have <a href="https://github.com/terryma/vim-multiple-cursors">a multiple cursors plugin</a> installed, for when I'm doing pair programming.</p>

<p>Have fun Vimming! üéπ‚å®Ô∏è</p>

        </div>
                    <p class="tags">
            <strong>Tags:</strong>
                        <a href="/blog/tags/Vim" class="tag">Vim</a>                        <a href="/blog/tags/Development" class="tag">Development</a>                        <a href="/blog/tags/IDE" class="tag">IDE</a>                        </p>
            </article>
    <article>
        <header class="page-header">
            <h1><a href="/blog/2018/02/05/wishful-development">Wishful Development</a></h1>
        </header>
        <div>
            <p>In this blogpost I'm going to try and explain the main way I solve problems by delaying things that I don't want to think about at the time that I'm solving them. I use "wishful thinking" for that (hence the title of this blog post), but I guess this could also be called <em>Interface Discovery</em>. Let's look at a specific problem:
For the CoffeeRun application that we used as an example in <a href="/blog/2017/11/15/refactoring-to-collections/">previous posts</a>, we want to make a tool that compares prices of a given drink between a list of shops in our neighbourhood. What's interesting to us is the comparison logic:</p>

<ol>
<li>We ask the tool to find the cheapest {drink of a certain type}</li>
<li>The tool shows us the cheapest coffee shop in our neighbourhood where we can get a {drink of that type}</li>
</ol>

<h2 id="wishful-thinking">Wishful Thinking</h2>

<p>Let's write that in a very na√Øve way: I wish there was a comparison class with a method to find the cheapest drink.</p>

<pre><code class="php">final class CompareCoffeeShops
{
    public function findCheapest(Drink $drink): CoffeeShop
    {
        $cheapestShop = array_reduce(
            $this-&gt;shops,
            function($cheapestShop, $nextShop) use ($drink) {
                $cheapestPrice = $cheapestShop-&gt;getPriceFor($drink);
                $nextPrice = $nextShop-&gt;getPriceFor($drink);

                if ($nextPrice-&gt;lowerThan($cheapestPrice)) {
                    return $nextShop;
                }

                return $cheapestShop;
            },
            reset($this-&gt;shops)
        );

        return $cheapestShop;
    }
}
</code></pre>

<p>We just made assumptions about <em>everything</em>. Let's see.</p>

<ol>
<li><p>We assumed there was a <code>Drink</code> class. There wasn't, so let's make it happen:</p>

<pre><code class="php">final class Drink
{
    private $name;

    public function __construct(string $name)
    {
        $this-&gt;name = $name;
    }
}
</code></pre></li>
<li><p>We assumed there was a list of coffee shops, oops, there was no such thing. Let's fix that by adding a constructor parameter:</p>

<pre><code class="php">final class CompareCoffeeShops
{
    private $shops;

    public function __construct(array $shops)
    {
        $this-&gt;shops = $shops;
    }

    public function findCheapest(Drink $drink): CoffeeShop
    {
        // ...
    }
}
</code></pre></li>
<li><p>Each <code>CoffeeShop</code> in the list seems to have a <code>getPriceFor(Drink)</code> method which returns a <code>Price</code>...</p>

<pre><code class="php">interface CoffeeShop
{
    public function getPriceFor(Drink $drink): Price;
}
</code></pre></li>
<li><p>Talking about <code>Price</code>, how do prices look? They certainly seem to have a <code>lowerThan(Price)</code> method</p>

<pre><code class="php">final class Price
{
    private $price;

    public function __construct(int $price)
    {
        $this-&gt;price = $price;
    }

    public function lowerThan(Price $other): bool
    {
        return $this-&gt;price &lt; $other-&gt;price;
    }
}
</code></pre></li>
</ol>

<p>Let's write a test too:</p>

<pre><code class="php">&lt;?php

use PHPUnit\Framework\TestCase;

class CompareCoffeeShopsTest extends TestCase
{
    public function test_it_finds_the_cheapest_cappuccino()
    {
        $shop1 = $this-&gt;createMock('CoffeeShop');
        $shop1-&gt;method('getPriceFor')-&gt;willReturn(new Price(200));

        $shop2 = $this-&gt;createMock('CoffeeShop');
        $shop2-&gt;method('getPriceFor')-&gt;willReturn(new Price(195));

        $shop3 = $this-&gt;createMock('CoffeeShop');
        $shop3-&gt;method('getPriceFor')-&gt;willReturn(new Price(250));

        $shops = array($shop1, $shop2, $shop3);

        $comparisons = new CompareCoffeeShops($shops);

        $cheapest = $comparisons-&gt;findCheapest(new Drink('Cappuccino'));

        $this-&gt;assertEquals($shop2, $cheapest);
    }
}
</code></pre>

<p>Wait, what? The test passes! (I know, I know, it's not complete...)</p>

<h2 id="why-is-this-great%3F">Why is this great?</h2>

<p>We just tested and implemented most of the comparison logic through "wishful thinking" (although in a very na√Øve way). The details about looking up the real prices of a cappuccino in all shops in our neighbourhood were left out. We didn't need them! We actually wrote the most important thing first, how to compare drinks in multiple shops and find the cheapest place to buy our cappuccino! Nothing even hints at trying to scrape their websites (god forbid) and we can actually give up on that temporarily and implement a hardcoded list of shops and their inventories until we find the courage needed to scrape coffeeshop websites üò±!</p>

<p>In fact, look at the interface that we need to implement to get this to work:</p>

<pre><code class="php">interface CoffeeShop
{
    public function getPriceFor(Drink $drink): Price;
}
</code></pre>

<p>It's so simple! We could implement this however we want, e.g. have some shops with hardcoded inventories, others with webscrapers. None of our code needs to know about the specific implementation of the shops, it already knows about the available methods. And as a bonus, we didn't write any code we didn't need.</p>

<p>Think about it: if you can imagine it, it already works. Have fun programming! üññ</p>

        </div>
                    <p class="tags">
            <strong>Tags:</strong>
                        <a href="/blog/tags/PHP" class="tag">PHP</a>                        <a href="/blog/tags/Development" class="tag">Development</a>                        <a href="/blog/tags/OOP" class="tag">OOP</a>                        </p>
            </article>
    <nav class="pager">
        <a href="/." class="left">Newer Posts</a>        <a href="/page/3" class="right">Older Posts</a>    </nav>
                </div>
            </div>
        </div>
        <footer class="container">
            &copy; 2018 CX Social Dev Blog
        </footer>

        <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
        <script>window.jQuery || document.write('<script src="/components/jquery/jquery.min.js"><\/script>')</script>
        <script src="/components/bootstrap/js/bootstrap.min.js"></script>
                
        
        <script type="text/javascript">
            (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
            })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

            ga('create', 'UA-105312561-1', 'auto');
            ga('send', 'pageview');
        </script>
                <script src="/components/highlightjs/highlight.pack.js"></script>
        <script>hljs.initHighlightingOnLoad();</script>

                    </body>
</html>
