<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <title><![CDATA[CX Social Dev Blog]]></title>
    <link href="/atom.xml" rel="self"/>
    <link href="/"/>
    <updated>2017-10-16T07:43:10+00:00</updated>
    <id>/</id>
        <generator uri="http://sculpin.io/">Sculpin</generator>
            <entry>
            <title type="html"><![CDATA[Tips on coding a web design close to reality]]></title>
            <link href="/blog/2017/10/16/coding-web-design-tips"/>
            <updated>2017-10-16T10:00:00+00:00</updated>
            <id>/blog/2017/10/16/coding-web-design-tips</id>
            <content type="html"><![CDATA[<p>Throughout my experience as a front end developer I've often heard designers complain about how developers fail to code a design accurately. Many designers ask their developers to make a webpage "pixel perfect". Queue developers rolling their eyes! Here I'll share my tips for bringing your code as close as possible to that psd.</p>

<h2 id="setting-expectations">Setting expectations</h2>

<p>One of the most impactful changes you can do is to make sure to set expectations with your designer. At the start it's a good idea to get your team together and figure out which parts of the design will or will not work in reality. If you're lucky you'll have an amazing product team that has done this for you. In reality the developer usually comes up with a technical pain point in the design. For example, if you find that some of the design won't translate in all browsers, you could come up with a compromise with your designer. For example, our gallery of canned responses uses a masonry layout. This layout doesn't look as perfect in Internet Explorer, but we were willing to put up with this because it meant we could use CSS for the masonry layout and not require to use a heavy javascript polyfill plugin. This slight compromise means our website will not have to forsake any page speed for the design.</p>

<p><center>
<img src="/images/2017-10-16-coding-web-design-tips/canned-responses-gallery-modern.png" alt="Canned responses gallery view in a modern browser" /><br />
<small>CX Social Inbox canned responses gallery view in a modern browser</small>
</center></p>

<p><center>
<img src="/images/2017-10-16-coding-web-design-tips/canned-responses-gallery-ie.png" alt="Canned responses gallery view in a Internet Explorer" /><br />
<small>CX Social Inbox canned responses gallery view in Internet Explorer 10</small>
</center></p>

<p>Ideally you only use javascript when absolutely nescessary for a design. I've seen it happen before that designers have asked for a <code>&lt;select&gt;</code> dropdown list to be styled, as the default is not as pretty as in other browsers. This requires a javascript plugin (I wrote one to do this myself at one point). But it's completely unnecessary when it does not affect the user experience that deeply. Users are used to the style of the default <code>&lt;select&gt;</code> dropdowns and it's not worth adding the extra javascript to your website. It's important to weigh up where your javascript is <em>really</em> enhancing the user experience. A slower website makes for a less smooth user experience!</p>

<h2 id="useful-plugins">Useful Plugins</h2>

<p>Let's check out some plugins that can come in handy to keep you and your designer happy!</p>

<h3 id="pixel-perfect">Pixel Perfect</h3>

<p>Designers love when I use <a href="https://addons.mozilla.org/en-US/firefox/addon/pixel-perfect/">this plugin</a>! You can pop in your design image and then overlay it on top of your webpage. Then you can use the inspector to adjust margins and padding in between elements.</p>

<p>My main advice when using this plugin is to be careful about fonts. Use the plugin to measure the distance <em>between</em> elements rather than making the entire page a perfect copy of the PSD. This is because the font in a PSD will not look the same in every browser. The most important part is getting the line height, margins and padding correct between the text and the next element. In this example you can see that the "Canned Responses" title is not the exact same in the PSD layover.</p>

<p><center>
<img src="/images/2017-10-16-coding-web-design-tips/canned-responses-pixel-perfect.png" alt="Using the pixel perfect plugin" /><br />
<small>Using the pixel perfect plugin</small>
</center></p>

<p><center>
<img src="/images/2017-10-16-coding-web-design-tips/canned-responses-pixel-perfect-inspector.png" alt="Using the pixel perfect plugin with the inspector" /><br />
<small>Using the pixel perfect plugin and adjusting padding to match the overlay mockup</small>
</center></p>

<h3 id="ruler-plugin">Ruler plugin</h3>

<p>A good <a href="https://addons.mozilla.org/en-US/firefox/addon/page-ruler/">ruler plugin</a> is great for when you want to maintain a consistent guttering/spacing between elements in your design. It also prevents arguments with the designer over whether some spacing is 15px or 20px ;)</p>

<p>Usually spacing between elements is consistent in the design - so if you do spot an inconsistency, ask your designer. E.g. If your webpage <code>h1</code> headings are normally 16px, but in the design they are 15px, this could be a slight mistake!</p>

<p><center>
<img src="/images/2017-10-16-coding-web-design-tips/using-the-ruler-plugin.png" alt="Using the ruler plugin" /><br />
<small>Using a ruler plugin to maintain consistent spacing</small>
</center></p>

<h2 id="useful-software">Useful software</h2>

<h3 id="zeplin">Zeplin</h3>

<p><a href="https://zeplin.io/">Zeplin</a> is a program that acts as a middleman between developers and designers. The designer can input the font sizes, spacing between elements and content for the developer to copy. This prevents the developer having to guess the dimensions of the design. It also generates a little bit of CSS - although in my experience you don't end up using most of that. Some CSS properties like <code>box-shadow</code> are useful. It's also useful for translating hex colours.</p>

<p><center>
<img src="/images/2017-10-16-coding-web-design-tips/spacing-between-elements-in-zeplin.png" alt="Examining the spacing between elements in Zeplin" /><br />
<small>Examining the spacing between elements in Zeplin</small>
</center></p>

<p><center>
<img src="/images/2017-10-16-coding-web-design-tips/font-details-in-zeplin.png" alt="Examining font details in Zeplin" /><br />
<small>Examining font details in Zeplin</small>
</center></p>

<p><center>
<img src="/images/2017-10-16-coding-web-design-tips/css-rules-in-zeplin.png" alt="Examining CSS rules in Zeplin" /><br />
<small>Examining CSS rules in Zeplin</small>
</center></p>

<h3 id="invision">Invision</h3>

<p><a href="https://www.invisionapp.com/">Invision</a> is an alternative to Zeplin, but it also includes project mockups. The inspector tool is very similar to Zeplin, so it depends on if you need software for your mockups in addition to software for being the "middleman" between developers and designers.</p>

<p><center>
<img src="/images/2017-10-16-coding-web-design-tips/using-invision-inspector.png" alt="Using the inspector in Invision" /><br />
<small>Using the inspector in Invision</small>
</center></p>

<h3 id="using-the-browser-inspector">Using the browser inspector</h3>

<p>This is the most important tool of course! Using the up and down keys in the CSS rules section you can tweak the width of elements until you get it right. Editing the styles in the inspector is where I spend most of my time when coding a design.</p>

<p><center>
<img src="/images/2017-10-16-coding-web-design-tips/using-the-inspector.png" alt="Using the browser inspector" /><br />
<small>Using the browser inspector</small>
</center></p>

<p>Utilize the device toolbar to get a preview of your site in other devices. When you're working on compatibility for Internet Explorer, I recommend utilizing the inspector on IE11 (or the latest IE version) as it will give you a preview back to IE8. The inspector in IE11 for compatibility mode gives you a pretty good idea of what something looks like in older versions. When you've done enough tweaking using the compatibility mode you can double check the <em>real</em> IE browser in a tool like <a href="https://www.browserstack.com/" target="_blank">Browserstack</a>. If you don't have BrowserStack you can <a href="https://developer.microsoft.com/en-us/microsoft-edge/tools/vms/" target="_blank">download a VM on modern.ie</a>.</p>

<h2 id="always-account-for-responsiveness">Always account for responsiveness</h2>

<p>It's likely your designer will give you a separate spec for the mobile version of your webpage. If they don't, you can ask them if they'd like you to improvise one. But whether you have a mockup for mobile or not, you should always write your code to be responsive. Responsive design is a whole other article, but <a href="https://www.w3schools.com/css/css_rwd_intro.asp" target="_blank">I recommend reading up on it</a>!</p>

<h2 id="conclusion">Conclusion</h2>

<p>As a frontend developer you need to work amicably with your designer to find the best technical solutions when implementing a design. Graceful degredation and user experience are the most important, but hopefully these tips also help you to come to a solution that works well for both the designer and the developer!</p>

<p>What developer tools do you use to help you implement designs?</p>
]]></content>
        </entry>
            <entry>
            <title type="html"><![CDATA[Vim As A PHP IDE - Debugging]]></title>
            <link href="/blog/2017/10/02/vim-ide-debugging"/>
            <updated>2017-10-02T10:00:00+00:00</updated>
            <id>/blog/2017/10/02/vim-ide-debugging</id>
            <content type="html"><![CDATA[<p><strong>This blogpost is part of the "Vim As A PHP IDE" series, which starts <a href="/blog/2017/01/01/vim-ide-setting-up">here</a>.</strong></p>

<p>A few weeks ago, I ended the "Vim As A PHP IDE" series with the <a href="/blog/2017/06/15/vim-ide-refactoring">refactoring</a> post. However, there's a huge thing missing from this series, and that's debugging. A lot of people debug their code using <code>var_dump</code> and <code>echo</code>, or worse, with self-made methods to markup the things they want to dump. Not only is this very old-school, there are also problems with this method. For instance, the dumped code affects the behaviour or the output of the running script. This is where the step debugger comes in.</p>

<p>A step debugger lets you step trough your code while it's running, so that you can inspect variables on the fly. This eliminates the need for dumping lines to the standard output, while giving you more insight in what's happening. e.g. you can see the whole stack trace and step through that as well...</p>

<p><a href="/images/2017-10-02-vim-ide-debugging/1.png"><img src="/images/2017-10-02-vim-ide-debugging/1.png" alt="screenshot of Vdebug in action" /></a></p>

<h2 id="how-does-this-work%3F">How does this work?</h2>

<p>Basically, the debugger, in the case of PHP <a href="https://xdebug.org/">xdebug</a>, hooks into the running code and exposes an API that you can use to set breakpoints, make the compiler run, etc... To install xdebug, follow the instructions on <a href="https://xdebug.org/docs/install">their documentation page</a>. Now you'll also have to add some lines to your <code>php.ini</code> configuration file. In my case it looks like this:</p>

<pre><code class="ini">[xdebug]
zend_extension="/path/to/xdebug.so"
xdebug.remote_enable=1
</code></pre>

<p>The important part is the <code>remote_enable=1</code>, which allows us to hook into the step debugger.</p>

<p>Then you, as a user, sets a breakpoint somewhere and inspects the state of the program at that point, using a "client" that knows how to speak the language of the debugger's API and integrates with your IDE. In our case that client is going to be the Vim plugin <a href="https://github.com/joonty/vdebug/">Vdebug</a>. You can install the plugin using your favorite plugin installation method.</p>

<h2 id="debugging-our-first-script">Debugging our first script</h2>

<p>Let's create a script <code>test.php</code> that we want to debug:</p>

<pre><code class="php">&lt;?php

$foo = 'bar';
$foo = 'baz';
</code></pre>

<p>We want to see what's inside the <code>$foo</code> variable during the time this script runs. In Vim, press <code>F5</code> to activate Vdebug. Now, run the script with debugging enabled:</p>

<pre><code class="sh">XDEBUG_CONFIG="idekey=xdebug" php test.php
</code></pre>

<p>You'll notice that the script seems to hang. In Vim, however, you'll see something like this happening:</p>

<p><img src="/images/2017-10-02-vim-ide-debugging/2.png" alt="Vdebug first startup screen" /></p>

<p>That's right! A new tab opened in Vim, containing the Vdebug window with the first breakpoint active. You can instantly see the local variables on the right, as well as the stack trace. If we now move our cursor to line <code>4</code> and press <code>F9</code>, to make the debugger run to that line and inspect the state right before it, we'll see that the <code>$foo</code> variable's value was changed to <code>'bar'</code>. Look ma, no <code>var_dump</code>!</p>

<p><img src="/images/2017-10-02-vim-ide-debugging/3.png" alt="Inspecting the $foo variable in Vdebug" /></p>

<p>You can also see the superglobals by hitting that tab in the variables screen:</p>

<p><img src="/images/2017-10-02-vim-ide-debugging/4.png" alt="Vdebug shows PHPs superglobals at this point in time" /></p>

<p>Great! Now you know the basics. Take a look at the other things you can do while debugging (stepping out, stepping over, etc) with Vdebug on <a href="https://github.com/joonty/vdebug/#quick-guide">their documentation's Quick Guide section</a>. To quickly stop debugging and return to where you were before, press <code>F6</code> twice.</p>

<p>Tip: if you don't want to set the environment variable every time, you can make XDebug try and run a remote debugger session all the time, and hook into it when you want to by enabling your client. Put this extra line in your <code>php.ini</code> configuration file:</p>

<pre><code class="ini">xdebug.remote_autostart=1
</code></pre>

<h2 id="debugging-code-that-is-run-by-a-webserver">Debugging code that is run by a webserver</h2>

<p>Running the debugger for web requests is also possible. If the webserver is running on your local machine, you don't have to change much (assuming XDebug is installed and configured as above): just append a parameter to your URL, like this <code>XDEBUG_SESSION_START=xdebug</code>. For instance, <code>https://foo.local/test.php</code> would become <code>https://foo.local/test.php?XDEBUG_SESSION_START=xdebug</code>. The debugger will now try to connect to your client!</p>

<p>So hereby we conclude this blog series about Vim as an IDE once more, and we hope that you liked it! Happy Debugging!</p>
]]></content>
        </entry>
            <entry>
            <title type="html"><![CDATA[Real-Time Webhooks API: Secure an Internship with us]]></title>
            <link href="/blog/2017/09/27/internship-webhooks-api"/>
            <updated>2017-09-27T11:00:00+00:00</updated>
            <id>/blog/2017/09/27/internship-webhooks-api</id>
            <content type="html"><![CDATA[<p>Are you a student looking for an internship for Spring 2018? We have a project involving real-time API's and webhooks that you might find interesting. Read on to know what we do here at CX Social and what the project is about.</p>

<h2 id="what-do-we-do%3F">What do we do?</h2>

<p>The Clarabridge CX Social team builds a customer care tool for social media. Our clients use our software to be able to respond to the incoming questions and complaints on their Facebook pages, Twitter accounts, Instagram profiles, a.o. These clients often have a high volume of messages, on several social profiles. We try to make those people‚Äôs lives easier by offering automation tools, smart routing of messages and reply suggestions, among others.
<a href="https://developers.engagor.com/team">Read more about what we do</a>.</p>

<p>As of February 2018, we have room for one or more enthusiastic interns to join us for (at least) a couple of weeks <em>(preferably 4 days a week, any time between February 2017 to June 2018)</em>, to work as part of the CX Social development team.
As an intern you are an integral part of the R&amp;D team working on different parts of the application using technologies like PHP, React, MySQL, Redis, memcached, ElasticSearch, RabbitMQ, a.o. The team consists of a designer, front-end developer, data scientist, and several system engineers &amp; full-stack web developers.
We are looking for a student with interest and knowledge of mainly back-end technologies, and some front-end knowledge.</p>

<p>Want to know more about what it‚Äôs like to do an internship here? Read about <a href="https://engagor.github.io/blog/2017/06/01/internship-gheerwijn-cx-social-developer/">Gheerwijn‚Äôs experiences</a> or the <a href="https://engagor.github.io/blog/2017/06/30/internship-achievements/">Achievements project intern Cedric is currently working on</a>.</p>

<h2 id="the-project%3A-webhooks-api">The Project: Webhooks API</h2>

<p>CX Social has an Rest (oAuth JSON) API used by several of our clients. Its documentation is publicly available on our <a href="https://developers.engagor.com">developer site</a> so have a look to see what‚Äôs possible with it.<br />
Its uses include displaying important social profile metrics on own websites, two-way syncing of data from the CX Social CRM to other (in-house or 3rd party) CRM‚Äôs (like Salesforce, a.o.). It‚Äôs also being used to display curated social mentions on own sites, or to combine data from CX Social with data from other tools on internal dashboards.</p>

<p>Today, the API is used in a <code>PULL</code> model only, where clients (periodically) request information from our API. This internship project involves a significant update to allow <code>PUSH</code> webhooks to be send to our clients.<br />
Clients have been requesting this feature, and are eager to start using it, to be notified of new data (e.g. new tweets), or updates to data (e.g. when a certain social contact‚Äôs information is filled in) in real-time.
The project would take inspiration from the <a href="https://developers.facebook.com/docs/graph-api/webhooks">Facebook Webhooks API</a>, <a href="https://dev.twitter.com/webhooks">Twitter Webhooks API</a>, or <a href="https://api.slack.com/custom-integrations/outgoing-webhooks">Slack‚Äôs Outgoing Webhooks API</a> and take into account other <a href="https://restful.io/webhooks-dos-and-dont-s-what-we-learned-after-integrating-100-apis-d567405a3671">common do's and don'ts regarding webhooks</a>.</p>

<p>It consists of the following features:</p>

<ul>
<li>Creating &amp; updating webhook-subscriptions (defining which webhooks should be delivered where). 

<ul>
<li>This should be possible via an API, as well as a web-interface;</li>
<li>Configured delivery URL‚Äôs should be checked for ownership by verification with configured handshake;</li>
<li>Configured delivery URL‚Äôs should be checked for validity of their SSL certificates;</li>
<li>Several types of subscriptions will be needed (i.e. subscribing to ‚Äúaccount‚Äù updates, and subscribing to ‚Äúuser‚Äù updates);</li>
</ul></li>
<li>A robust webhook delivery system, consisting of:

<ul>
<li>Re-delivery when the delivery URL‚Äôs is unresponsive;</li>
<li>Trying to guarantee exactly-once delivery;</li>
<li>Signed webhook payloads, so receivers can verify the origin of the request;</li>
<li>Notifying the API user via email when their delivery URL continues to be unresponsive;</li>
</ul></li>
<li>Implementing the event-log that eventually triggers the webhooks:

<ul>
<li>Making sure changes in the CX Social code base trigger an event to the webhooks system;</li>
<li>Distribution of events to the right subscriptions</li>
</ul></li>
<li>Monitoring of the system to:

<ul>
<li>Be alerted when webhook delivery is running behind.</li>
</ul></li>
</ul>

<p><center>
<img src="/images/2017-09-27-internships-webhooks-api/slow-delivery.gif" alt="Slow Delivery" /><br />
<small>Our future clients, when their webhooks aren't delivered on time.</small>
</center></p>

<p>Together with the CX Social development team, you as an intern are responsible for choosing the right technologies &amp; architecture. For those interested in backend technologies, this will be an exciting project, that you can help shape, build and deploy to production.</p>

<h2 id="interested%3F">Interested?</h2>

<p>We are looking for someone to join us in the Gent, Belgium office of Clarabridge, located at <a href="https://www.google.be/maps/place/CX+Social/@51.0597245,3.7213322,17z/data=!3m1!4b1!4m5!3m4!1s0x47c37138e71c8617:0x314cae371e7de8a5!8m2!3d51.0597245!4d3.7235209">Grauwpoort 1, 9000 Gent</a>.
Does this seem like a fun challenge for you? Please reach out to <a href="&#x6d;&#97;&#105;l&#x74;&#x6f;&#58;&#106;&#x75;&#x72;&#114;&#105;a&#x61;&#110;&#46;p&#x65;&#x72;&#115;&#121;&#x6e;&#x40;&#99;&#108;a&#x72;&#x61;&#98;&#114;&#x69;&#x64;&#103;&#101;&#x2e;&#x63;&#111;&#109;">jurriaan.persyn@clarabridge.com</a> with your details and we can set-up an interview to see if there‚Äôs a fit.</p>

<p><center>
<img src="/images/2017-09-27-internships-webhooks-api/thumbs.jpg" alt="Toppie" /><br />
<small>Our future clients, when you've implemented this cool feature.</small>
</center></p>
]]></content>
        </entry>
            <entry>
            <title type="html"><![CDATA[Using decorators for debugging]]></title>
            <link href="/blog/2017/09/22/using-decorators-for-debugging"/>
            <updated>2017-09-22T10:00:00+00:00</updated>
            <id>/blog/2017/09/22/using-decorators-for-debugging</id>
            <content type="html"><![CDATA[<p>When you're writing SOLID code, you probably hide some implementation details behind interfaces in many parts of your codebase. In this post, we'll talk about an HTTP client, which is hidden behind an interface. The exact implementation we use doesn't matter. It could be a simple cURL call, or we could be using a more advance package like <a href="https://github.com/guzzle/guzzle/">Guzzle</a> or <a href="https://github.com/kriswallsmith/Buzz">Buzz</a>. In any case, our application knows only about the <code>HttpClient</code> interface that it defined, like this.</p>

<pre><code class="php">&lt;?php

namespace CoffeeRun;

interface HttpClient
{
    /**
     * @param Request $request An HTTP Request
     *
     * @throws ClientException if the request failed
     *
     * @return Response a response instance
     */
    public function execute(Request $request): Response;
}
</code></pre>

<p>Our code will ask the <code>HttpClient</code> implementation to <code>execute()</code> a <code>Request</code> and expects a <code>Response</code> if the call succeeded, or a <code>ClientException</code> if something unexpected happens.</p>

<p>The cool thing about this, is that our whole codebase needs to only know about this one interface, and not about the specific package that we're going to use. Plus, we can use another (fake) implementation of the <code>HttpClient</code> interface during testing.</p>

<h2 id="decorators">Decorators</h2>

<p>Now let's say that we want our application to make all HTTP calls with a certain User-Agent header. We don't want to go into our code and change every occurrence of <code>new Request</code> to also include that specific header. This is where decorators come in. We can "wrap" the <code>HttpClient</code> instance in a shell that acts as if it's the original <code>HttpClient</code>, but just takes the incoming <code>Request</code> and adds that header to it, and then passes on the call to the wrapped <code>HttpClient</code>. Like this:</p>

<pre><code class="php">&lt;?php

namespace CoffeeRun;

final class ClientWithUserAgent implements HttpClient
{
    private $wrappedClient;
    private $userAgentString;

    public function __construct(HttpClient $wrappedClient, $userAgentString = 'Coffee Bot 1.0')
    {
        $this-&gt;wrappedClient = $wrappedClient;
        $this-&gt;userAgentString = (string) $userAgentString;
    }

    public function execute(Request $request): Response
    {
        $request = $request-&gt;withHeader('User-Agent', $this-&gt;userAgentString);

        return $this-&gt;wrappedClient-&gt;execute($request);
    }
}
</code></pre>

<p>Creating an instance looks something like this:</p>

<pre><code>&lt;?php

$httpClient = new ClientWithUserAgent(
    new ClientCurl(),
    'ROBOCOP'
);
</code></pre>

<p>As this Decorator also implements the same <code>HttpClient</code> interface, the application doesn't even know this is happening, because from the outside it looks and behaves exactly the same. This change essentially now is a change in the configuration file of our Dependency Injection Container, no other files needed to be changed to make this happen.</p>

<h2 id="using-decorators-for-investigation">Using decorators for investigation</h2>

<p>Now, if we want to investigate the requests and responses that we get from a service while the application is running, e.g. when an unidentified bug is happening, we could do it with a decorator. The rest of the application won't know about it and should just keep on working as usual, while we get logs of the data that we want:</p>

<pre><code class="php">&lt;?php

namespace CoffeeRun;

final class LoggingClient implements HttpClient
{
    private $wrappedClient;
    private $logger;

    public function __construct(HttpClient $wrappedClient, LoggerInterface $logger)
    {
        $this-&gt;wrappedClient = $wrappedClient;
        $this-&gt;logger = $logger;
    }

    public function execute(Request $request): Response
    {
        $this-&gt;logger-&gt;debug('request', $request);

        $response = $this-&gt;wrappedClient-&gt;execute($request);

        $this-&gt;logger-&gt;debug('response', $response);

        return $response;
    }
}
</code></pre>

<p>The request and response are logged in our logs now, and they look good to us, but we still haven't found what we're looking for and we want to see if the requests our app is making work from the command line using <code>curl</code>. What if we made our application also log the complete curl commands? Then we could just copy paste them in our terminal to test them locally.</p>

<pre><code class="php">&lt;?php

namespace CoffeeRun;

final class CurlCommandLoggingClient implements HttpClient
{
    private $wrappedClient;
    private $logger;

    public function __construct(HttpClient $wrappedClient, LoggerInterface $logger)
    {
        $this-&gt;wrappedClient = $wrappedClient;
        $this-&gt;logger = $logger;
    }

    public function execute(Request $request): Response
    {
        $method = $request-&gt;getMethod();
        $url = $request-&gt;getUrl();
        $params = $request-&gt;getParams();
        $headers = $request-&gt;getHeaders();

        $curlString = 'curl';
        $curlString .= ' --' . strtolower($method);

        foreach ($params as $key =&gt; $value) {
            $curlString .= ' --data "' . $key . '=' . $value . '"';
        }

        foreach ($headers as $key =&gt; $value) {
            $curlString .= ' --header "' . $key . '=' . $value . '"';
        }

        $curlString .= ' "' . $url . '"';

        $this-&gt;logger-&gt;debug('curl command', $curlString);

        return $this-&gt;client-&gt;execute($request);
    }
}
</code></pre>

<p>Of course, this is an oversimplified way of building the <code>curl</code> command, but this will help you debug your HTTP calls by copy/pasting them to your terminal! Easy as that, and still no changes to the existing code. It takes one line to change it, and one line to delete and bring it back to production values.</p>

<h2 id="concerns">Concerns</h2>

<ul>
<li>Liskov Substition Principle: It's very important that our decorators still adhere to the original contract of the wrapped instance (in this case the <code>HttpClient</code> interface). If the decorator would produce another return value, or take different method parameters, it wouldn't work.</li>
<li>Applying a decorator that logs a lot of data in production might have an impact on your host. This is just an example of using your existing interfaces to create some plug &amp; play debugging solutions. If you do something like this in production, use the same caution as with other changes in production.</li>
</ul>

<p>That's it! Have fun.</p>
]]></content>
        </entry>
            <entry>
            <title type="html"><![CDATA[A trip to Nordic.js ‚úàÔ∏è]]></title>
            <link href="/blog/2017/09/15/nordicjs"/>
            <updated>2017-09-15T10:00:00+00:00</updated>
            <id>/blog/2017/09/15/nordicjs</id>
            <content type="html"><![CDATA[<p><center>
<img src="/images/2017-09-15-nordicjs/nordicjs.png" alt="Nordic.js cover" /><br />
</center></p>

<p>This year I was finally able to make it to <a href="http://nordicjs.com/">Nordic.js</a> whoot whoot.
This conference deserves to be on your radar! Read on for some impressions from a fellow dev.</p>

<h2 id="talks-%F0%9F%91%A9%E2%80%8D%F0%9F%8F%AB%F0%9F%91%A8%E2%80%8D%F0%9F%8F%AB">Talks üë©‚Äçüè´üë®‚Äçüè´</h2>

<p><em>At the time of writing no videos are online but they will be soonish. Check the <a href="https://www.youtube.com/user/nordicjs">Nordic.js youtube channel</a> for updates.</em></p>

<p>This was the first single track conference I went to and I actually prefer this format compared to multi-track conferences where you always tend to shift to things familiar. "Just serve me the menu, I trust the chefs" is much more enjoyable, and oh boy these chefs deserve some Michelin stars because the menu was delicious.</p>

<p>Talks were about Javascript, frontend development in general and the Javascript community. Below a small list of my favourites.</p>

<h3 id="sociolinguistics-and-the-javascript-community%3A-a-love-story"><a href="http://nordicjs.com/speakers#harriet-lawrence">Sociolinguistics and the Javascript community: a love story</a></h3>

<p>Let's start with "community". 
The most surprising talk of the conference was about sociolinguistics.
Not something that I would choose on a multi-track conference but super glad I saw this one. Small things can make a huge difference, and I love that.</p>

<blockquote class="twitter-tweet" data-lang="en"><p lang="en" dir="ltr">Don‚Äôt use words like ‚Äúeasy‚Äù or ‚Äúsimple‚Äù in instructions so users don‚Äôt feel ashamed if they fail. Brilliant talk <a href="https://twitter.com/harrietgl">@harrietgl</a>! üëè <a href="https://twitter.com/hashtag/NordicJS?src=hash">#NordicJS</a> <a href="https://t.co/4aly56IzC0">pic.twitter.com/4aly56IzC0</a></p>&mdash; Jyri Tuulos (@jtuulos) <a href="https://twitter.com/jtuulos/status/905736469226151936">September 7, 2017</a></blockquote>

<p><em>video coming soon</em></p>

<h3 id="best-practices-for-reusable-ui-components"><a href="http://nordicjs.com/speakers#mars-jullian">Best Practices for reusable UI components</a></h3>

<p>Next up was a talk about React, which we use day to day at CXSocial, so any talk about it is always insightful. You often think big companies use complex techniques but actually everything can be pretty straightforward. Great tips from Mars and if you are starting out with React you should definitely check them out.</p>

<blockquote class="twitter-tweet" data-lang="en"><p lang="en" dir="ltr">Reusable UI components should be: <br>1. self-sufficient<br>2. easy to integrate with<a href="https://twitter.com/marsjosephine">@marsjosephine</a> <a href="https://twitter.com/hashtag/nordicjs?src=hash">#nordicjs</a> <a href="https://twitter.com/hashtag/react?src=hash">#react</a> ‚öõ</p>&mdash; Nordic.js (@nordicjs) <a href="https://twitter.com/nordicjs/status/905780159248310272">September 7, 2017</a></blockquote>

<p><em>video coming soon</em></p>

<h3 id="p2p"><a href="http://nordicjs.com/speakers#feross-aboukhadijeh">P2P</a></h3>

<p>How did I miss that P2P is a thing now in browsers? Luckily we got this great intro by Feross.</p>

<blockquote class="twitter-tweet" data-lang="en"><p lang="en" dir="ltr">I love how <a href="https://twitter.com/feross">@feross</a> has just given a super approachable talk about peer to peer üíñ also with great slides and demos! <a href="https://twitter.com/hashtag/nordicjs?src=hash">#nordicjs</a></p>&mdash; fantastic ms. üá∏üá™ (@fox) <a href="https://twitter.com/fox/status/906132074058457092">September 8, 2017</a></blockquote>

<p><em>video coming soon</em></p>

<h2 id="conference-%F0%9F%8E%9F">Conference üéü</h2>

<p>Here are some things that things that made the conference stand out:</p>

<h3 id="make-new-friends-%F0%9F%91%AD%F0%9F%91%AB">Make new friends üë≠üë´</h3>

<p>Nordic.js does everything in it's power to make everyone feel welcome and loved. The diverse group of people that show up is a testimony to that. A community I feel proud to be a part of.</p>

<p>The conference organizes "Dinner with new friends", a fun way to meet new people. They book a table at a restaurant in Stockholm for you and 5 other people from the conference. If you are a shy person like me you instantly have 5 new conference buddies.</p>

<h3 id="festen-%F0%9F%8E%89">Festen üéâ</h3>

<p>During the conference after party you can participate in a "Code In The Dark" competition. Create a HTML frontend site without testing your code. Does it scare you? Well me too but it's fun to watch brave souls attempt it, I suddenly understand sports now. Why wait until the conference you can actually organize it yourself just check <a href="http://codeinthedark.com/">codeinthedark.com</a>.</p>

<blockquote class="twitter-tweet" data-lang="en"><p lang="en" dir="ltr">The Code in the Dark has started! What a cool experience! <a href="https://twitter.com/hashtag/NordicJS?src=hash">#NordicJS</a> <a href="https://twitter.com/hashtag/JavaScript?src=hash">#JavaScript</a> <a href="https://twitter.com/hashtag/FrontEnd?src=hash">#FrontEnd</a> <a href="https://t.co/0A2gnzT2bl">pic.twitter.com/0A2gnzT2bl</a></p>&mdash; Sweet Systems (@sweet_systems) <a href="https://twitter.com/sweet_systems/status/906196233945055232">September 8, 2017</a></blockquote>

<script async src="//platform.twitter.com/widgets.js" charset="utf-8"></script>

<p>And the party well what can I say that's the most epic funtastic awesomist conference after party ever.</p>

<blockquote class="instagram-media" data-instgrm-version="7" style=" background:#FFF; border:0; border-radius:3px; box-shadow:0 0 1px 0 rgba(0,0,0,0.5),0 1px 10px 0 rgba(0,0,0,0.15); margin: 1px; max-width:658px; padding:0; width:99.375%; width:-webkit-calc(100% - 2px); width:calc(100% - 2px);"><div style="padding:8px;"> <div style=" background:#F8F8F8; line-height:0; margin-top:40px; padding:38.47222222222222% 0; text-align:center; width:100%;"> <div style=" background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACwAAAAsCAMAAAApWqozAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAMUExURczMzPf399fX1+bm5mzY9AMAAADiSURBVDjLvZXbEsMgCES5/P8/t9FuRVCRmU73JWlzosgSIIZURCjo/ad+EQJJB4Hv8BFt+IDpQoCx1wjOSBFhh2XssxEIYn3ulI/6MNReE07UIWJEv8UEOWDS88LY97kqyTliJKKtuYBbruAyVh5wOHiXmpi5we58Ek028czwyuQdLKPG1Bkb4NnM+VeAnfHqn1k4+GPT6uGQcvu2h2OVuIf/gWUFyy8OWEpdyZSa3aVCqpVoVvzZZ2VTnn2wU8qzVjDDetO90GSy9mVLqtgYSy231MxrY6I2gGqjrTY0L8fxCxfCBbhWrsYYAAAAAElFTkSuQmCC); display:block; height:44px; margin:0 auto -44px; position:relative; top:-22px; width:44px;"></div></div><p style=" color:#c9c8cd; font-family:Arial,sans-serif; font-size:14px; line-height:17px; margin-bottom:0; margin-top:8px; overflow:hidden; padding:8px 0 7px; text-align:center; text-overflow:ellipsis; white-space:nowrap;"><a href="https://www.instagram.com/p/BYy1yxMhcP0/" style=" color:#c9c8cd; font-family:Arial,sans-serif; font-size:14px; font-style:normal; font-weight:normal; line-height:17px; text-decoration:none;" target="_blank">Een bericht gedeeld door Peter van der Meulen (@hendrikpetertje)</a> op <time style=" font-family:Arial,sans-serif; font-size:14px; line-height:17px;" datetime="2017-09-08T21:01:47+00:00">8 Sep 2017 om 2:01 PDT</time></p></div></blockquote>

<p><script async defer src="//platform.instagram.com/en_US/embeds.js"></script>
<small>Me and some new conference friends with an old familiar.</small></p>

<h2 id="practical-%F0%9F%92%B5">Practical üíµ</h2>

<p>Some prices if you are trying to conference on a budget.</p>

<ul>
<li>Ticket: Regular Bird - 678 euro</li>
<li>Flights: Brussels Zaventem &lt;=> Stockholm Bromma (Brussels airlines) - 95 euro</li>
<li>Lodging: Skanstulls Vandrarhem 3 nights - 83 euro</li>
</ul>

<h2 id="tips-%E2%9C%94">Tips ‚úî</h2>

<p>I walked everywhere during my trip (except from the airport to the city center). Stockholm is a beautiful city and very pedestrian-friendly.</p>

<p>Want to buy tickets for next year? Sign up for the <a href="http://nordicjs.com">Nordic.js newsletter</a> and be fast very fast because it sells out quickly.</p>

<script async src="//platform.twitter.com/widgets.js" charset="utf-8"></script>
]]></content>
        </entry>
            <entry>
            <title type="html"><![CDATA[Star Vars, an intergalactic story of tiny code smells]]></title>
            <link href="/blog/2017/09/01/star-vars"/>
            <updated>2017-09-01T10:00:00+00:00</updated>
            <id>/blog/2017/09/01/star-vars</id>
            <content type="html"><![CDATA[<p>In this post, we'll look at a type of variables that I call Star Vars, they're stars and shouldn't be touched. In any case. Whatsoever. Just don't start editing these in your code, or you'll eventually break stuff, with 100% guarantee.</p>

<h2 id="star-vars-i%3A-the-timestamp-menace">Star Vars I: The Timestamp Menace</h2>

<p>Timestamps are nice: asking the Unix Epoch timestamp results in a number that's the same, independent of in which timezone you are. The secret to this, is that a moment in history was labeled as Unix Epoch, and the timestamp is just the number of seconds that has passed from that moment up until now.</p>

<p>And that's where things start to get nasty: with the understanding of what the number means (the number of seconds passed since January 1st 1970), people start editing the number to get dates in the past or future. What they're almost never take in consideration is the fact that time isn't linear, dates aren't the same around the globe, there are leap seconds, leap years, etc. There are too many exceptions from the rule, to just start adding <code>60 * 60 * 24</code> seconds to a timestamp's value, to get the next day. Don't do it. Your language most probably has a <code>DateTime</code> package to do just that, with less mistakes.</p>

<h2 id="star-vars-ii%3A-attack-of-the-%60%24_post%60">Star Vars II: Attack Of The <code>$_POST</code></h2>

<p>When a HTTP request is made to your app, there are most likely <code>POST</code> or <code>GET</code> parameters being passed along. In PHP, and likely other languages, these are made available trough (global) variables, no different than other variables. Thus, they can be changed, or used in computations or output. Be very careful with that!</p>

<p>Changing a global variable means that it will be changed everywhere, so you risk breaking functionality in other places when you change e.g. the <code>$_POST</code> variable. Optimally, you could reduce the risk by using the immutable datastructures that your PSR-7 framework makes available to you.</p>

<p>Also, using user input in calculations and/or output might result in errors or major hacks of your software. Be very cautious! People might be able to steal your app's data, run arbitrary code on your server, or impersonate users.</p>

<h2 id="star-vars-iii%3A-events-of-the-sith">Star Vars III: Events Of The Sith</h2>

<p>Since forever now, people use event dispatching and event sourcing as a way to let systems know about state changes, or even build their state from scratch based on events only. These <em>events</em> are nothing more than a "record" of something that has happened (in the past complete sense). Something that has happened will never change anymore, so the variables holding events should never be changed. Events are <em>immutable</em>. If you do change them, you change history, which I assume you aren't enabled to do.</p>

<h2 id="star-vars-iv%3A-a-new-%60%24row%60">Star Vars IV: A New <code>$row</code></h2>

<p>Here's the classic "naming things" exercise. We all know it's hard, but it's also very important. Take your time, give variables an appropriate name. I'm not touching your <code>$row</code> because I don't know what it is.</p>

<h2 id="star-vars-v%3A-the-query-strikes-back">Star Vars V: The Query Strikes Back</h2>

<p>Whether you're using an ORM or not, you might write the occasional database query from time to time. I find myself still writing my own queries for the sake of simplicity, inside the database specific implementation of e.g. a repository. Sometimes, for instance when you need "filter" functionality over a huge number of entities based on their various properties, it's tempting to write a query in a very generic way so that reusable parts of the query get concatenated into one final query. I find this a very dangerous practice, all the while not providing much benefit over writing the same query a few times with minor changes. Since the repository implementation we're doing this in is the only place in our codebase that knows about the database, we shouldn't care too much about duplication here.</p>

<h2 id="star-vars-vi%3A-return-of-the-id">Star Vars VI: Return Of The ID</h2>

<p>Making assumptions about the form of variables can be quite dangerous. Let's say that you expect a string to be in place, but what you get is an empty string. Is that valid? Now, think of identifiers of different objects. Sometimes, people use incremental numeric values (more often than not generated by the database) as identifiers for their objects, e.g. the <code>Person</code> with id <code>1337</code> is a cool guy. Already I can think of multiple cases of unexpected values for numerical ids, like <code>0</code>, <code>-1</code>, <code>false</code>, <code>null</code>, <code>''</code>, <code>foo</code>... If we then make the assumption that we'll save them as an integer in the database, we'll shoot ourselves in the foot by saving an object with id <code>'arrow'</code> or <code>'knee'</code>. Or what if the id is a numerical value that is too big to fit inside an integer?</p>

<p>How about string representations, do you ask? For instance, post ids on the Facebook API have ids in the form of <code>{page id}_{post id}</code>. Now that you know this, given a post with an id, could you tell me the page id? Yes, but... what if Facebook decides to change their <em>naming scheme</em> for new posts (which they actually do from time to time)? From now on posts are called <code>pid_{random number}</code>. Now if we had logic in our software that depended on the implicit knowledge of the id was being made of two parts, it will break for those new posts.</p>

<p>The moral of the story is: ids are black boxes, they could contain anything, and we shouldn't make assumptions about them, break them up into meaningful parts, or save them as anything else than strings inside the database.</p>

<h2 id="star-vars-vii%3A-the-%60git-push---force%60-awakens">Star Vars VII: The <code>git push --force</code> Awakens</h2>

<p>Even though <code>git</code> isn't a variable in the context of this blog post, I wanted to put this one in: <code>git push --force</code> is evil. The only reason why you would want to do this, is to change <em>public history</em>, which is something that can't be done. For more about that, scroll up to the Star Vars III section, or read <a href="/blog/2017/01/24/some-tips-for-a-better-git-history/">this blog post about git</a>.</p>

<h2 id="star-vars-viii%3A-the-last-url">Star Vars VIII: The Last URL</h2>

<p>The last, but not least, "star var" is the URL. Now, we all know and understand the most basic building blocks of URLs, like the scheme, tld, and query. But actually, the standard for URLs is quite complicated, and there could be many moving parts. People don't always include the scheme (e.g. the <code>https://</code> part), or the TLD is longer than 3 characters. Therefor, parsing an URL, or changing anything meaningful of it could be very error-prone. Have a look at <a href="https://daringfireball.net/2010/07/improved_regex_for_matching_urls">this regular expression to parse an URL</a>. As you can see, it's not as simple as you think. In fact, most languages have <a href="https://secure.php.net/manual/en/function.parse-url.php">built-in functionality</a> for this, as well as <a href="http://uri.thephpleague.com/">great packages</a>. As a side-note, the same goes for e-mail addresses, telephone numbers, and many other things.</p>

<p>That's it for now! Keep in mind that a lot of these problems can be solved by either using established packages, built-in language features, or <a href="https://martinfowler.com/bliki/ValueObject.html">Value Objects</a> (or a mixture of several of those). May the force be with you!</p>
]]></content>
        </entry>
            <entry>
            <title type="html"><![CDATA[5 simple rules for simpler code]]></title>
            <link href="/blog/2017/08/21/simple-rules-for-simpler-code"/>
            <updated>2017-08-21T11:00:00+00:00</updated>
            <id>/blog/2017/08/21/simple-rules-for-simpler-code</id>
            <content type="html"><![CDATA[<p>We as developers care about simple code. Simple code makes it easier to read and debug code which will allow you to build new features and fix bugs faster.</p>

<p>In this blogpost I would like to explain a few simple rules to get simpler code. The code examples will be written in PHP and are therefore more suited to procedural programming languages.</p>

<h2 id="1.-avoid-else">1. Avoid else</h2>

<p>This is probably my favourite rule. Avoiding else can drastically improve the readability of your code. For example:</p>

<pre><code class="php">if ($isAllowedToReadAutomationRecipes) {
  $automationRecipes = $this-&gt;repository-&gt;getByAccountId($accountId);
} else {
  $automationRecipes = [];
}
</code></pre>

<p>You can almost always simplify this to:</p>

<pre><code class="php">$automationRecipes = [];
if ($isAllowedToReadAutomationRecipes) {
  $automationRecipes = $this-&gt;repository-&gt;getByAccountId($accountId);
}
</code></pre>

<p>Look ma, no else!</p>

<h2 id="2.-use-early-returns">2. Use early returns</h2>

<p>Early returns are a nice way to simplify code. Using early returns goes hand in hand with avoiding else. For example:</p>

<pre><code class="php">class PostController
{
    public function delete()
    {
        $post = $this-&gt;repository-&gt;getById($postId);
        if ($post) {
            if ($isConfirmed) {
                $user-&gt;deletePost($post);
                $success = $this-&gt;repository-&gt;persist($post);
                if ($success) {
                    return $this-&gt;success('The post was successfully deleted');
                } else {
                    return $this-&gt;error('Something went wrong.');
                }
            } else {
                return $this-&gt;confirm('Are you sure you want to delete this post?');
            }
        } else {
            return $this-&gt;error('The post was not found.');
        }
    }
}
</code></pre>

<p>It's really hard to see the flow of the code, don't you think? Let's refactor the example to use early returns:</p>

<pre><code class="php">class PostController
{
    public function delete()
    {
        $post = $this-&gt;repository-&gt;getById($postId);
        if ($post === null) {
            return $this-&gt;error('The post was not found.');
        }
        if ($isConfirmed === false) {
            return $this-&gt;confirm('Are you sure you want to delete this post?');
        }

        $user-&gt;deletePost($post);
        $success = $this-&gt;repository-&gt;persist($post);
        if ($success === false) {
            return $this-&gt;error('Something went wrong. Try again.');
        }

        return $this-&gt;success('The post was successfully deleted');
    }
}
</code></pre>

<p>What do you prefer? I surely prefer the latter. Early returns keep the level of indentation low and make the happy path of the code visible.</p>

<h2 id="3.-use-meaningful-variables-names">3. Use meaningful variables names</h2>

<p>If you abbreviate the names of variables you probably don't have a good IDE (autocompletion). It might make sense to use abbreviations while writing some quick code but it will eventually shoot you in the back when you need to fix a bug. You'll lose valuable time by deciphering the code.</p>

<h2 id="4.-avoid-code-comments">4. Avoid code comments</h2>

<p>Each time you're commenting code you're failing to express yourself. This rule goes hand in hand with meaningful variable names. Code comments can get outdated and nothing is as damaging as lies and misinformation. The code is the only source of truth. If you find yourself writing a code comment think of ways to make it clear in the code by extracting variables and functions with meaningful names. Sometimes a well placed comment can be helpful. They'll likely explain the why while the code explains the what/how.</p>

<h2 id="5.-follow-a-consistent-coding-standard">5. Follow a consistent coding standard</h2>

<p>Following a consistent coding standard makes sure all code is formatted in the same way. Which makes it easier to read code because you expect it to be formatted in a specific way. For PHP this is <a href="http://www.php-fig.org/psr/psr-2/">PSR-2</a>. I don't like every rule in <a href="http://www.php-fig.org/psr/psr-2/">PSR-2</a> but it doesn't matter as long as everyone writes the same code. Please don't invent your own coding standard. It's a good practice to <a href="http://cs.sensiolabs.org/">lint and fix</a> coding style automatically.</p>

<h2 id="conclusion">Conclusion</h2>

<p>I hope these simple rules will inspire you to leave the campground cleaner than you found it. Which rules do you think are important? Leave a comment (on disqus they are allowed)! If you want to know more, <a href="https://www.amazon.com/Clean-Code-Handbook-Software-Craftsmanship/dp/0132350882">Clean Code</a> is good read.</p>

<p>"Avoiding else" is a rule from <a href="https://www.cs.helsinki.fi/u/luontola/tdd-2009/ext/ObjectCalisthenics.pdf">Object Calisthenics</a>. If you want to become a better developer, read it.</p>
]]></content>
        </entry>
            <entry>
            <title type="html"><![CDATA[Some tips for better PHPUnit tests]]></title>
            <link href="/blog/2017/08/01/tips-for-better-phpunit-tests"/>
            <updated>2017-08-01T10:00:00+00:00</updated>
            <id>/blog/2017/08/01/tips-for-better-phpunit-tests</id>
            <content type="html"><![CDATA[<p>Writing good unit tests can be a pain. When you write your tests superfluously, you're testing more than the single unit, and they start failing with reasons not related to the <em>Subject Under Test (SUT)</em>. Or your tests become unreadable, and you can't figure out what they were supposed to be testing. Or they test only the one situation where everything goes according to plan, and not possible errors. Of course we want to mitigate all that! Let's see some simple tips to keep your test suite clean and working all the time.</p>

<h2 id="test-the-unhappy-path-first">Test the unhappy path first</h2>

<p>You could've sworn that your test was complete, but there seem to be exceptional cases that you missed. When writing unit tests -and doing TDD in particular- thinking about what might go wrong is very important: how should your unit fail, and when? What should happen when it fails? Should it throw exceptions? If you start with this, you won't forget to do it, and you'll write more robust code as a side-effect.</p>

<h2 id="assertions-have-a-structure">Assertions have a structure</h2>

<p>You might not know it, but most PHPUnit assertions have their parameters in the same order. They almost always take <code>$expected</code> and <code>$actual</code> as first and second parameters respectively. The third (and optional) parameter is often <code>$message</code>, which is a specific message you can write to make PHPUnit rapport back to you with when something fails. This is important, because in case of failure, PHPUnit will report you that your assertion's actual value doesn't match what you expected (so order is significant here). Let's see some examples:</p>

<pre><code class="php">$this-&gt;assertEquals($expected, $actual, $message);
$this-&gt;assertSame($expected, $actual, $message);
$this-&gt;assertTrue($condition, $message);
</code></pre>

<p>As you can see, the <code>assertTrue()</code> call misses an <code>$expected</code> part, as it's already made clear in the name of the assertion.</p>

<h2 id="use-the-correct-assertion">Use the correct assertion</h2>

<p>To me, the daddy of all assertions is <code>assertEquals</code>, it's the basis of a unit test. You assert that your <em>Subject Under Test</em> gives a return value that's equal to what you expect it to return. If you're in doubt about which assertion is the right one to use, always pick <code>assertEquals</code>. The added benifit you get, is that PHPUnit displays really nice diffs between the <code>$expected</code> and <code>$actual</code> values if they don't match. That's much less useful when you use <code>assertTrue</code>, and it can only tell you that <code>False</code> is not equal to <code>True</code>.</p>

<p><img src="/images/2017-08-01-tips-for-better-phpunit-tests/phpunit-diff.png" alt="Diff that PHPUnit shows when expected is different than the actual value" /></p>

<h2 id="pick-names-that-make-sense">Pick names that make sense</h2>

<p>PHPUnit expects you to start the name of your test methods with <code>test</code>, so that you get names like <code>testItThrowsAnExceptionWhenNetworkIsDown()</code>. Although that name is quite descriptive (and it should be!) it doesn't read very well. We can, however, make much more readable function names using underscores. What do you think of <code>test_it_throws_an_exception_when_network_is_down()</code>? It might not fit your coding standard (i'm looking at you, PSR-2), but isn't readability worth the occasional exception to some rules that are meant for readability? Also note, that be reading the name of the test method like this, it's totally clear to me what that test does, and I don't have to go in and read the code if I don't need to change it.</p>

<h2 id="data-providers-for-clear-failure-messages">Data Providers for clear failure messages</h2>

<p>If you need to test the same method with a huge number of inputs and make the same assertion over and over again, you might be tempted to write your assertion inside a <code>foreach</code> loop or something similar.</p>

<pre><code class="php">public function test_prices_cast_to_strings()
{
    $validPrices = array(
        '$100' =&gt; new Price(10000),
        '$10' =&gt; new Price(1000),
        '$1' =&gt; new Price(100),
        '$0.10' =&gt; new Price(10),
        '$0.01' =&gt; new Price(1),
    );

    foreach ($validPrices as $expectedString =&gt; $price) {
        $this-&gt;assertEquals($expectedString, (string) $price);
    }
}
</code></pre>

<p>The problem with this, is that all your assertions happen on the same line, and PHPUnit will rapport a failure in one of those assertions as a failure on that line. Then you'll have to play detective and start looking through your test data to see where things break. This is where PHPUnit Data Providers come in handy, check it out:</p>

<pre><code class="php">/**
 * @dataProvider validPrices
 */
public function test_prices_cast_to_strings($expectedString, $price)
{
    $this-&gt;assertEquals($expectedString, (string) $price);
}

public function validPrices()
{
    return array(
        array('$100', new Price(10000)),
        array('$10', new Price(1000)),
        array('$1', new Price(100)),
        array('$0.10', new Price(10)),
        array('$0.01', new Price(1)),
    );
}
</code></pre>

<p>Now PHPUnit will tell you which input data made the test fail. Don't you think this also cleans up the test so much more? No more <code>foreach</code> that didn't add any meaning to the test! What's also good to know, is that the <code>@dataProvider</code> annotation also works in conjunction with the <code>@expectedException</code> annotation, so you can also easily test if your method throws exceptions for invalid input.</p>

<pre><code class="php">/**
 * @dataProvider invalidPrices
 * @expectedException InvalidArgumentException
 */
public function test_prices_throw_when_built_from_non_integer_value($nonInteger)
{
    $price = new Price($nonInteger);
}

public function invalidPrices()
{
    return array(
        array('foo'),
        array(null),
        array(true),
        array(false),
        array(0.01),
        array('1'),
    );
}
</code></pre>

<h2 id="programming-against-interfaces">Programming against interfaces</h2>

<p>When you're writing tests for a SOLID codebase, be it in a test-first fashion, or writing tests after the facts, you'll be glad you used interfaces for your <em>Subject Under Test</em>'s dependencies. Not only do they give you the obvious benefits of "being able to swap out dependencies with a totally different implementation" or "not caring about specifics, if you just adhere to the contract", but also this means that you can test your class without its dependencies! Look at this example, where <code>Bank</code> has two dependencies:</p>

<pre><code class="php">&lt;?php

final class Bank
{
    private $clock;
    private $log;

    public function __construct(Clock $clock, TransactionLog $log)
    {
        $this-&gt;clock = $clock;
        $this-&gt;log = $log;
    }

    // ...
}
</code></pre>

<p>Of course, <code>Bank</code> cannot operate without its dependencies, so in our test we'll have to instantiate it correctly, but we'll use test doubles, so that we can test <code>Bank</code> with e.g. a <code>Clock</code> that we control:</p>

<pre><code class="php">$clock = $this-&gt;getMock('Clock');
$clock
    -&gt;method('getTime')
    -&gt;willReturn(new DateTime('2017-07-15 10:00:00'));

$log = $this-&gt;getMock('TransactionLog');

$bank = new Bank($clock, $log);
</code></pre>

<p>Now that we know that <code>Clock</code> will always return a given time, we can make assertions that e.g. a <code>Bank</code> transaction was done at the time the clock returned, instead of taking a guess and using stuff like <code>time()</code> or <code>new DateTime('now')</code>. On the <code>TransactionLog</code>, we could assert that a certain method got called (because we expect a transaction to be made), and thus validate if the <code>Bank</code> communicates correctly with it:</p>

<pre><code class="php">$now = new DateTime('2017-07-15 10:00:00');
$clock = $this-&gt;getMock('Clock');
$clock
    -&gt;method('getTime')
    -&gt;willReturn($now);

$transaction = new Transaction('Toon', 'Hans', 100, $now);
$log = $this-&gt;getMock('TransactionLog');
$log
    -&gt;expects($this-&gt;once())
    -&gt;method('log')
    -&gt;with($this-&gt;equalTo($transaction));

$bank = new Bank($clock, $log);
$bank-&gt;payment('Toon', 'Hans', 100);
</code></pre>

<p>On the last line we do the call that your code would actually do to make a bank transaction (this is example code, beware). This makes the <code>Bank</code> log a <code>Transaction</code> in the <code>TransactionLog</code>. Since we control the clock, we can assert on the correct time in the <code>Transaction</code>. Also note that this is a complete test. The rather invisible assertion is the <code>$this-&gt;equalTo()</code> call. We're asserting that <code>Bank</code> communicates correctly to the <code>TransactionLog</code>.</p>

<h2 id="interface-discovery">Interface Discovery</h2>

<p>When we're doing TDD, the PHPUnit test doubles can help us "discovering" what an interface must be, in order to have a dependency that properly supports our <em>Subject Under Test</em>. This works because PHPUnit's mocks will mock any non-existing interfaces. Let's say we want the bank to trigger a WebHook whenever a transaction was made, containing the transaction details.</p>

<pre><code class="php">$clock = $this-&gt;getMock('Clock');
$log = $this-&gt;getMock('TransactionLog');

// The WebHooks interface doesn't exist yet
$webhooks = $this-&gt;getMock('WebHooks');
$webhooks
    -&gt;expects($this-&gt;once())
    -&gt;method('trigger')
    -&gt;with($this-&gt;equalTo('{"transaction": {"from": "Toon", "to": "Hans", "amount": 100}}'));

$bank = new Bank($clock, $log, $webhooks);
$bank-&gt;payment('Toon', 'Hans', 100);
</code></pre>

<p>Without having an interface, we can already define what we want to see happening. Our test then fails, because the <code>trigger()</code> method didn't get called, so we can start implementing. When we're done, we'll see that our <code>Bank</code> class tests green, and we have discovered a very simple interface for the <code>WebHooks</code> that we can now create (see a whole blog post about this in the Further Reading section).</p>

<pre><code class="php">&lt;?php

interface WebHooks
{
    public function trigger($jsonContents);
}
</code></pre>

<h2 id="further-reading">Further Reading</h2>

<p>These were only a few of the things that you can do to make your testsuite better than it is right now! There are lots of ways to improve even further. My strategy is to not only refactor the code (when tests are green of course), but also the tests, to make them as comprehensive and robust as possible. Think about how you can make them easy to understand for the next person looking to improve or change them. Here's some more reading material that can help you out:</p>

<ul>
<li><a href="https://phpunit.de/manual/current/en/">The PHPUnit manual</a></li>
<li><a href="https://github.com/mockery/mockery">Much nicer test doubles with Mockery</a></li>
<li><a href="http://verraes.net/2011/03/interface-discovery-with-phpunit-mock-objects/">Interface Discovery with PHPUnit's Mock Objects</a></li>
</ul>

<p>That's it, enjoy writing better tests!</p>
]]></content>
        </entry>
            <entry>
            <title type="html"><![CDATA[How We Handle Perceived Performance]]></title>
            <link href="/blog/2017/07/10/perceived-performance"/>
            <updated>2017-07-10T10:00:00+00:00</updated>
            <id>/blog/2017/07/10/perceived-performance</id>
            <content type="html"><![CDATA[<h2 id="what-is-perceived-performance%3F">What is perceived performance?</h2>

<p>Perceived performance refers to how fast a user thinks your site is, rather than the actual site speed. It's a metric measured by humans rather than a site speed test tool. How fast does the website feel? For example, Facebook appears faster by loading a placeholder for posts in the News Feed. It's useful to know that a site is only loading rather than functioning slowly.</p>

<h2 id="how-cx-social-handles-perceived-performance">How CX Social Handles Perceived Performance</h2>

<p>CX Social is a large application that has a complex interface. The "inbox" part of our system has multiple small features, that all appear to be on a single page. The perceived performance of the inbox is more important than the actual speed, especially because it provides a seamless user experience. The following are a few things we do to portray a speedier performance!</p>

<h2 id="when-a-mention-is-resolved">When a mention is resolved</h2>

<p>In CX Social we process small pieces of information we call "mentions". A mention is any blog post, news article, tweet, etc. that matches any of your specified criteria. All mentions are refined into the CX Social inbox, where support agents can mark them as <em>resolved</em> when they are replied to/labelled as no action needed, etc. When a mention is <em>resolved</em> the support agent is automatically shown the next <em>mention</em> to attend to.
When a mention is resolved we manipulate the DOM and remove the element <em>before</em> the request is completed successfully. This gives you the impression that your action is completed instantly. In the rare case that the request fails, we replace the DOM element and display a relevant error message, so that the user knows what's going on and can resolve the mention again.</p>

<p><center>
<img src="/images/2017-07-10-perceived-performance/mentionresolve.gif" alt="Resolving a mention in CX Social Inbox" /><br />
<small>Resolving a mention in CX Social Inbox</small>
</center></p>

<h2 id="loading-indicators">Loading Indicators</h2>

<p>Loading icons can become a bit annoying on snappy pages because you see a flickering behaviour, and it makes the user feel as though they have to unnecessarily <em>wait</em>. Snappy pages don't require a loading icon, but we'd like a back up plan in case the page takes longer than expected to load. In this case, we use a timeout function for the loading functionality, and only show the loading interface when the request takes over X milliseconds to complete.</p>

<p><center>
<img src="/images/2017-07-10-perceived-performance/delayloading.gif" alt="Delay loading" /><br />
<small>Don't show a loading indicator for quick requests</small>
</center></p>

<p>In this instance, there's a 3000 millisecond delay on the loading behaviour for this page.</p>

<p><center>
<img src="/images/2017-07-10-perceived-performance/delayloadingspinner.gif" alt="Delay loading" /><br />
<small>Do show a loading indicator when a request is taking longer than usual</small>
</center></p>

<h2 id="placeholder-mentions-in-inbox">Placeholder mentions in inbox</h2>

<p>Similar to how Facebook shows a preview of your feed by showing mini placeholders for each post, we show a placeholder when loading a list of mentions in CX Social. 
We immediately show the selected mention, but for other mentions in the thread we automatically show a mention placeholder while they're loading. Then when the user scrolls farther in the thread, we pop in the next mentions. This gives structure to the page, while data is loading and thus makes it easier for the eye/mind to prepare for that data to be there.</p>

<p><center>
<img src="/images/2017-07-10-perceived-performance/inboxloading.gif" alt="Loading of inbox" /><br />
<small>Placeholder sections for mentions in the CX Social inbox</small>
</center></p>

<h2 id="additional-information-in-dropdowns%2Fpopups">Additional information in dropdowns/popups</h2>

<p>When you display a popup or dropdown there's no need to fetch every piece of information immediately. On each Twitter mention we have a "following" dropdown which shows the list of profiles that is following the author of the mention. It also shows whether you are following <em>that</em> profile and if <em>that</em> profile is following <em>you</em>. However we only load the latter information when the dropdown is opened. Sometimes we hit Twitter rate limits, and still try to display relevant following info based on our cache. If we don't have any info, we will still show the dropdown with ability to follow someone (but without displaying who they're already following) since those two endpoints have separate rate limits.</p>

<p><center>
<img src="/images/2017-07-10-perceived-performance/twitterfollowers.gif" alt="Loading of Twitter Followers" /><br />
<small>Dropdown that shows if you are following the author of a mention and vice versa</small>
</center></p>

<h2 id="loading-new-content-without-a-page-reload">Loading new content without a page reload</h2>

<p>We have a large sidebar in CX Social for navigation, as well as a top menu bar. When switching between pages, we just request the content for the main part of the page, and insert the new main content. This saves us doing a full page load.</p>

<h2 id="wrapping-up">Wrapping up</h2>

<p>Have you implemented any features to improve perceived performance? We'd love to hear about it!</p>
]]></content>
        </entry>
            <entry>
            <title type="html"><![CDATA[Achievement Unlocked: Secure an Internship with us]]></title>
            <link href="/blog/2017/06/30/internship-achievements"/>
            <updated>2017-06-30T16:30:00+00:00</updated>
            <id>/blog/2017/06/30/internship-achievements</id>
            <content type="html"><![CDATA[<p>Are you a student looking for an internship for 2017-2018? We have a fun project for you...</p>

<h2 id="what-do-we-do%3F">What do we do?</h2>

<p>The Clarabridge CX Social team builds a customer care tool for social media. Our clients use our software to be able to respond to the incoming questions and complaints on their Facebook pages, Twitter accounts, Instagram profiles, a.o. These clients often have a high volume of messages, on several social profiles. We try to make those people‚Äôs lives easier by offering automation tools, smart routing of messages and reply suggestions, among others.<br />
<a href="https://developers.engagor.com/team">Read more about what we do</a>.</p>

<p>As of September 2017, we have room for one or more enthusiastic interns to join us for (at least) a couple of weeks <em>(preferably 4 days a week, any time between September 2017 to June 2018)</em>, to work as part of the CX Social development team. As an intern you are an integral part of the R&amp;D team working on different parts of the application using technologies like PHP, React, MySQL, Redis, memcached, Elasticsearch, RabbitMQ, a.o. The other team members include a designer, front-end developer, data scientist, and several system engineers &amp; full-stack web developers.<br />
We are looking for a student with interest and knowledge of both front-end and back-end technologies.</p>

<p>Want to hear from a previous intern what it‚Äôs like to join our team? Read about <a href="https://engagor.github.io/blog/2017/06/01/internship-gheerwijn-cx-social-developer/">Gheerwijn‚Äôs experiences</a>.</p>

<h2 id="the-project%3A-achievements%21">The Project: Achievements!</h2>

<p>A big percentage of users work in our customer care tool full time, day-in day-out. So it‚Äôs important for us to keep the user experience for them smooth and enjoyable. We want to make the experience more fun by developing an achievement based system in the web-application.</p>

<p>Apart from making CX Social more fun for agents to work in, we aim to improve team work, increase retention and let users discover new features.</p>

<p><center>
<img src="/images/2017-06-30-internship-achievements/notification.png" alt="NMBS Twitter Profile" /><br />
<small>An achievement notification popping up in the CX Social interface.</small>
</center></p>

<p>Some of the tasks we‚Äôre thinking of...</p>

<ul>
<li>Implementing user profiles, with a live feed of completed achievements throughout the account.</li>
<li>Help out thinking about possible ways of implementing.</li>
<li>Taking part in brainstorms.</li>
<li>Preparing for weekly status meetings, communicating about the progress of the project.</li>
<li>Having lots of fun, while trying to make this feature the best it can possibly be.</li>
</ul>

<p><center>
<img src="/images/2017-06-30-internship-achievements/achievements.png" alt="NMBS Twitter Profile" /><br />
<small>A series of achievements for using one of CX Social's features: Canned Responses.</small>
</center></p>

<h2 id="interested%3F">Interested?</h2>

<p>We are looking for someone to join us in the Gent, Belgium office of Clarabridge, located at Grauwpoort 1, 9000 Gent.</p>

<p>Does this seem like a fun challenge for you? Please reach out to <a href="&#x6d;&#97;&#105;l&#x74;&#x6f;&#58;&#106;&#x75;&#x72;&#114;&#105;a&#x61;&#110;&#46;p&#x65;&#x72;&#115;&#121;&#x6e;&#x40;&#99;&#108;a&#x72;&#x61;&#98;&#114;&#x69;&#x64;&#103;&#101;&#x2e;&#x63;&#111;&#109;">jurriaan.persyn@clarabridge.com</a> with your details, and the requirements for your internship, and we‚Äôll be in touch!</p>

<p><center>
<img src="/images/2017-06-30-internship-achievements/profile-page.png" alt="NMBS Twitter Profile" /><br />
<small>A user profile with overview of completed achievements, personal information and live feed with account activity. </small>
</center></p>
]]></content>
        </entry>
    </feed>